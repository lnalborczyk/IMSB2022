<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 3 Modèle de régression linéaire | Notes de cours - Introduction à la modélisation statistique bayésienne</title>
  <meta name="description" content="<p>Ce document regroupe les notes de l’édition 2022 de la formation doctorale
‘Introduction à la modélisation statistique bayésienne’, co-organisée par le collège
des écoles doctorales de l’Université Grenoble Alpes et la Maison de la Modélisation
et de la Simulation, Nanoscience et Environnement (MaiMoSiNE).</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 3 Modèle de régression linéaire | Notes de cours - Introduction à la modélisation statistique bayésienne" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.barelysignificant.com/IMSB2022/_notes/./figures/cover_distributions.png" />
  <meta property="og:description" content="<p>Ce document regroupe les notes de l’édition 2022 de la formation doctorale
‘Introduction à la modélisation statistique bayésienne’, co-organisée par le collège
des écoles doctorales de l’Université Grenoble Alpes et la Maison de la Modélisation
et de la Simulation, Nanoscience et Environnement (MaiMoSiNE).</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 3 Modèle de régression linéaire | Notes de cours - Introduction à la modélisation statistique bayésienne" />
  
  <meta name="twitter:description" content="<p>Ce document regroupe les notes de l’édition 2022 de la formation doctorale
‘Introduction à la modélisation statistique bayésienne’, co-organisée par le collège
des écoles doctorales de l’Université Grenoble Alpes et la Maison de la Modélisation
et de la Simulation, Nanoscience et Environnement (MaiMoSiNE).</p>" />
  <meta name="twitter:image" content="https://www.barelysignificant.com/IMSB2022/_notes/./figures/cover_distributions.png" />

<meta name="author" content="Ladislas Nalborczyk" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="./figures/cover_distributions.png" type="image/x-icon" />
<link rel="prev" href="2-beta-binomial.html"/>
<link rel="next" href="4-linear-regression2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<!-- font families -->

<link href="https://fonts.googleapis.com/css?family=PT+Sans|Pacifico|Source+Sans+Pro" rel="stylesheet">

<script src="js/hideOutput.js"></script>

<!-- Mathjax -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/default.js"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>
-->

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction à la modélisation statistique bayésienne</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction à l’inférence bayésienne</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-introduction.html"><a href="1-introduction.html#quest-ce-quune-probabilité"><i class="fa fa-check"></i><b>1.1</b> Qu’est-ce qu’une probabilité ?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1-introduction.html"><a href="1-introduction.html#axiomes-des-probabilités"><i class="fa fa-check"></i><b>1.1.1</b> Axiomes des probabilités</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-introduction.html"><a href="1-introduction.html#interprétations-probabilistes"><i class="fa fa-check"></i><b>1.1.2</b> Interprétations probabilistes</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-introduction.html"><a href="1-introduction.html#logique-et-raisonnement-scientifique"><i class="fa fa-check"></i><b>1.2</b> Logique et raisonnement scientifique</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1-introduction.html"><a href="1-introduction.html#introduction-à-la-logique"><i class="fa fa-check"></i><b>1.2.1</b> Introduction à la logique</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-introduction.html"><a href="1-introduction.html#quelques-syllogismes-connus"><i class="fa fa-check"></i><b>1.2.2</b> Quelques syllogismes connus</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-introduction.html"><a href="1-introduction.html#quest-ce-quune-théorie-scientifique"><i class="fa fa-check"></i><b>1.2.3</b> Qu’est-ce qu’une théorie scientifique ?</a></li>
<li class="chapter" data-level="1.2.4" data-path="1-introduction.html"><a href="1-introduction.html#test-dhypothèse-nulle-et-raisonnement-scientifique"><i class="fa fa-check"></i><b>1.2.4</b> Test d’hypothèse nulle et raisonnement scientifique</a></li>
<li class="chapter" data-level="1.2.5" data-path="1-introduction.html"><a href="1-introduction.html#lapproche-par-comparaison-de-modèles"><i class="fa fa-check"></i><b>1.2.5</b> L’approche par comparaison de modèles</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-introduction.html"><a href="1-introduction.html#problème-du-sac-de-billes-mcelreath_statistical_2016"><i class="fa fa-check"></i><b>1.3</b> Problème du sac de billes <span class="citation">(<span>McElreath, 2016b</span>)</span></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1-introduction.html"><a href="1-introduction.html#énumérer-les-possibilités"><i class="fa fa-check"></i><b>1.3.1</b> Énumérer les possibilités</a></li>
<li class="chapter" data-level="1.3.2" data-path="1-introduction.html"><a href="1-introduction.html#accumulation-dévidence"><i class="fa fa-check"></i><b>1.3.2</b> Accumulation d’évidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="1-introduction.html"><a href="1-introduction.html#incorporer-un-prior"><i class="fa fa-check"></i><b>1.3.3</b> Incorporer un prior</a></li>
<li class="chapter" data-level="1.3.4" data-path="1-introduction.html"><a href="1-introduction.html#des-énumérations-aux-probabilités"><i class="fa fa-check"></i><b>1.3.4</b> Des énumérations aux probabilités</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-introduction.html"><a href="1-introduction.html#rappels-de-théorie-des-probabilités"><i class="fa fa-check"></i><b>1.4</b> Rappels de théorie des probabilités</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1-introduction.html"><a href="1-introduction.html#probabilité-conjointe"><i class="fa fa-check"></i><b>1.4.1</b> Probabilité conjointe</a></li>
<li class="chapter" data-level="1.4.2" data-path="1-introduction.html"><a href="1-introduction.html#probabilité-marginale"><i class="fa fa-check"></i><b>1.4.2</b> Probabilité marginale</a></li>
<li class="chapter" data-level="1.4.3" data-path="1-introduction.html"><a href="1-introduction.html#probabilité-conditionnelle"><i class="fa fa-check"></i><b>1.4.3</b> Probabilité conditionnelle</a></li>
<li class="chapter" data-level="1.4.4" data-path="1-introduction.html"><a href="1-introduction.html#dérivation-du-théorème-de-bayes"><i class="fa fa-check"></i><b>1.4.4</b> Dérivation du théorème de Bayes</a></li>
<li class="chapter" data-level="1.4.5" data-path="1-introduction.html"><a href="1-introduction.html#loi-de-probabilité-cas-discret"><i class="fa fa-check"></i><b>1.4.5</b> Loi de probabilité, cas discret</a></li>
<li class="chapter" data-level="1.4.6" data-path="1-introduction.html"><a href="1-introduction.html#loi-de-probabilité-cas-continu"><i class="fa fa-check"></i><b>1.4.6</b> Loi de probabilité, cas continu</a></li>
<li class="chapter" data-level="1.4.7" data-path="1-introduction.html"><a href="1-introduction.html#aparté-quest-ce-quune-intégrale"><i class="fa fa-check"></i><b>1.4.7</b> Aparté, qu’est-ce qu’une intégrale ?</a></li>
<li class="chapter" data-level="1.4.8" data-path="1-introduction.html"><a href="1-introduction.html#notations-terminologie"><i class="fa fa-check"></i><b>1.4.8</b> Notations, terminologie</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-introduction.html"><a href="1-introduction.html#quelques-exemples-dapplication"><i class="fa fa-check"></i><b>1.5</b> Quelques exemples d’application</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1-introduction.html"><a href="1-introduction.html#diagnostique-médical-gigerenzer-2002"><i class="fa fa-check"></i><b>1.5.1</b> Diagnostique médical (Gigerenzer, 2002)</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-introduction.html"><a href="1-introduction.html#problème-de-monty-hall"><i class="fa fa-check"></i><b>1.5.2</b> Problème de Monty Hall</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html"><i class="fa fa-check"></i><b>2</b> Modèle beta-binomial</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#coefficient-binomial"><i class="fa fa-check"></i><b>2.1</b> Coefficient binomial</a></li>
<li class="chapter" data-level="2.2" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#le-modèle-beta-binomial"><i class="fa fa-check"></i><b>2.2</b> Le modèle Beta-Binomial</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#loi-de-bernoulli"><i class="fa fa-check"></i><b>2.2.1</b> Loi de Bernoulli</a></li>
<li class="chapter" data-level="2.2.2" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#processus-de-bernoulli"><i class="fa fa-check"></i><b>2.2.2</b> Processus de Bernoulli</a></li>
<li class="chapter" data-level="2.2.3" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#processus-de-bernoulli-1"><i class="fa fa-check"></i><b>2.2.3</b> Processus de Bernoulli</a></li>
<li class="chapter" data-level="2.2.4" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#coefficient-binomial-1"><i class="fa fa-check"></i><b>2.2.4</b> Coefficient binomial</a></li>
<li class="chapter" data-level="2.2.5" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#loi-binomiale"><i class="fa fa-check"></i><b>2.2.5</b> Loi binomiale</a></li>
<li class="chapter" data-level="2.2.6" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#générer-des-données-à-partir-dune-distribution-binomiale"><i class="fa fa-check"></i><b>2.2.6</b> Générer des données à partir d’une distribution binomiale</a></li>
<li class="chapter" data-level="2.2.7" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#définition-du-modèle-likelihood"><i class="fa fa-check"></i><b>2.2.7</b> Définition du modèle (likelihood)</a></li>
<li class="chapter" data-level="2.2.8" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#vraisemblance-versus-probabilité"><i class="fa fa-check"></i><b>2.2.8</b> Vraisemblance versus probabilité</a></li>
<li class="chapter" data-level="2.2.9" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#définition-du-prior"><i class="fa fa-check"></i><b>2.2.9</b> Définition du prior</a></li>
<li class="chapter" data-level="2.2.10" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#la-distribution-beta"><i class="fa fa-check"></i><b>2.2.10</b> La distribution Beta</a></li>
<li class="chapter" data-level="2.2.11" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#interprétation-des-paramètres-du-prior-beta"><i class="fa fa-check"></i><b>2.2.11</b> Interprétation des paramètres du prior Beta</a></li>
<li class="chapter" data-level="2.2.12" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#prior-conjugué"><i class="fa fa-check"></i><b>2.2.12</b> Prior conjugué</a></li>
<li class="chapter" data-level="2.2.13" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#dérivation-analytique-de-la-distribution-a-posteriori"><i class="fa fa-check"></i><b>2.2.13</b> Dérivation analytique de la distribution a posteriori</a></li>
<li class="chapter" data-level="2.2.14" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#un-exemple-pour-digérer"><i class="fa fa-check"></i><b>2.2.14</b> Un exemple pour digérer</a></li>
<li class="chapter" data-level="2.2.15" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#influence-du-prior-sur-la-distribution-postérieure"><i class="fa fa-check"></i><b>2.2.15</b> Influence du prior sur la distribution postérieure</a></li>
<li class="chapter" data-level="2.2.16" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#ce-quil-faut-retenir"><i class="fa fa-check"></i><b>2.2.16</b> Ce qu’il faut retenir</a></li>
<li class="chapter" data-level="2.2.17" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#la-vraisemblance-marginale-the-devil-is-in-the-denominator"><i class="fa fa-check"></i><b>2.2.17</b> La vraisemblance marginale (the devil is in the denominator)</a></li>
<li class="chapter" data-level="2.2.18" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#la-distribution-postérieure-solution-analytique"><i class="fa fa-check"></i><b>2.2.18</b> La distribution postérieure, solution analytique</a></li>
<li class="chapter" data-level="2.2.19" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#la-distribution-postérieure-grid-method"><i class="fa fa-check"></i><b>2.2.19</b> La distribution postérieure, grid method</a></li>
<li class="chapter" data-level="2.2.20" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#échantillonner-la-distribution-postérieure"><i class="fa fa-check"></i><b>2.2.20</b> Échantillonner la distribution postérieure</a></li>
<li class="chapter" data-level="2.2.21" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#la-distribution-postérieure-résumé"><i class="fa fa-check"></i><b>2.2.21</b> La distribution postérieure, résumé</a></li>
<li class="chapter" data-level="2.2.22" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#utiliser-les-échantillons-pour-résumer-la-distribution-postérieure"><i class="fa fa-check"></i><b>2.2.22</b> Utiliser les échantillons pour résumer la distribution postérieure</a></li>
<li class="chapter" data-level="2.2.23" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#highest-density-interval-hdi"><i class="fa fa-check"></i><b>2.2.23</b> Highest density interval (HDI)</a></li>
<li class="chapter" data-level="2.2.24" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#region-of-practical-equivalence-rope"><i class="fa fa-check"></i><b>2.2.24</b> Region of practical equivalence (ROPE)</a></li>
<li class="chapter" data-level="2.2.25" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#model-checking"><i class="fa fa-check"></i><b>2.2.25</b> Model checking</a></li>
<li class="chapter" data-level="2.2.26" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#posterior-predictive-checking"><i class="fa fa-check"></i><b>2.2.26</b> Posterior predictive checking</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-beta-binomial.html"><a href="2-beta-binomial.html#conclusions"><i class="fa fa-check"></i><b>2.3</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html"><i class="fa fa-check"></i><b>3</b> Modèle de régression linéaire</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#langage-de-la-modélisation"><i class="fa fa-check"></i><b>3.1</b> Langage de la modélisation</a></li>
<li class="chapter" data-level="3.2" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#un-premier-modèle"><i class="fa fa-check"></i><b>3.2</b> Un premier modèle</a></li>
<li class="chapter" data-level="3.3" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#loi-normale"><i class="fa fa-check"></i><b>3.3</b> Loi normale</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#doù-vient-la-loi-normale"><i class="fa fa-check"></i><b>3.3.1</b> D’où vient la loi normale ?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#modèle-gaussien"><i class="fa fa-check"></i><b>3.4</b> Modèle gaussien</a></li>
<li class="chapter" data-level="3.5" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#visualiser-le-prior"><i class="fa fa-check"></i><b>3.5</b> Visualiser le prior</a></li>
<li class="chapter" data-level="3.6" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#échantillonner-à-partir-du-prior"><i class="fa fa-check"></i><b>3.6</b> Échantillonner à partir du prior</a></li>
<li class="chapter" data-level="3.7" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#fonction-de-vraisemblance"><i class="fa fa-check"></i><b>3.7</b> Fonction de vraisemblance</a></li>
<li class="chapter" data-level="3.8" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#distribution-postérieure"><i class="fa fa-check"></i><b>3.8</b> Distribution postérieure</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#distribution-postérieure---grid-approximation"><i class="fa fa-check"></i><b>3.8.1</b> Distribution postérieure - grid approximation</a></li>
<li class="chapter" data-level="3.8.2" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#distribution-postérieure---distributions-marginales"><i class="fa fa-check"></i><b>3.8.2</b> Distribution postérieure - distributions marginales</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#introduction-à-brms"><i class="fa fa-check"></i><b>3.9</b> Introduction à brms</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#rappels-de-syntaxe"><i class="fa fa-check"></i><b>3.9.1</b> Rappels de syntaxe</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#quelques-fonctions-utiles"><i class="fa fa-check"></i><b>3.9.2</b> Quelques fonctions utiles</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#un-premier-exemple"><i class="fa fa-check"></i><b>3.9.3</b> Un premier exemple</a></li>
<li class="chapter" data-level="3.9.4" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#en-utilisant-notre-prior"><i class="fa fa-check"></i><b>3.9.4</b> En utilisant notre prior</a></li>
<li class="chapter" data-level="3.9.5" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#en-utilisant-un-prior-plus-informatif"><i class="fa fa-check"></i><b>3.9.5</b> En utilisant un prior plus informatif</a></li>
<li class="chapter" data-level="3.9.6" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#précision-du-prior-heuristique"><i class="fa fa-check"></i><b>3.9.6</b> Précision du prior (heuristique)</a></li>
<li class="chapter" data-level="3.9.7" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#récupérer-et-visualiser-les-échantillons-de-la-distribution-postérieure"><i class="fa fa-check"></i><b>3.9.7</b> Récupérer et visualiser les échantillons de la distribution postérieure</a></li>
<li class="chapter" data-level="3.9.8" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#récupérer-les-échantillons-de-la-distribution-postérieure"><i class="fa fa-check"></i><b>3.9.8</b> Récupérer les échantillons de la distribution postérieure</a></li>
<li class="chapter" data-level="3.9.9" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#visualiser-la-distribution-postérieure"><i class="fa fa-check"></i><b>3.9.9</b> Visualiser la distribution postérieure</a></li>
<li class="chapter" data-level="3.9.10" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#visualiser-la-distribution-postérieure-1"><i class="fa fa-check"></i><b>3.9.10</b> Visualiser la distribution postérieure</a></li>
<li class="chapter" data-level="3.9.11" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#ajouter-un-prédicteur"><i class="fa fa-check"></i><b>3.9.11</b> Ajouter un prédicteur</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#régression-linéaire-à-un-prédicteur-continu"><i class="fa fa-check"></i><b>3.10</b> Régression linéaire à un prédicteur continu</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#différentes-notations-équivalentes"><i class="fa fa-check"></i><b>3.10.1</b> Différentes notations équivalentes</a></li>
<li class="chapter" data-level="3.10.2" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#représenter-les-prédictions-du-modèle"><i class="fa fa-check"></i><b>3.10.2</b> Représenter les prédictions du modèle</a></li>
<li class="chapter" data-level="3.10.3" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#représenter-lincertitude-sur-mu-via-fitted"><i class="fa fa-check"></i><b>3.10.3</b> Représenter l’incertitude sur <span class="math inline">\(\mu\)</span> via fitted()</a></li>
<li class="chapter" data-level="3.10.4" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#intervalles-de-prédiction-incorporer-sigma"><i class="fa fa-check"></i><b>3.10.4</b> Intervalles de prédiction (incorporer <span class="math inline">\(\sigma\)</span>)</a></li>
<li class="chapter" data-level="3.10.5" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#deux-types-dincertitude"><i class="fa fa-check"></i><b>3.10.5</b> Deux types d’incertitude</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#régression-polynomiale"><i class="fa fa-check"></i><b>3.11</b> Régression polynomiale</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#modèle-de-régression-polynomiale"><i class="fa fa-check"></i><b>3.11.1</b> Modèle de régression polynomiale</a></li>
<li class="chapter" data-level="3.11.2" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#représenter-les-prédictions-du-modèle-1"><i class="fa fa-check"></i><b>3.11.2</b> Représenter les prédictions du modèle</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#modèle-de-régression-taille-deffet"><i class="fa fa-check"></i><b>3.12</b> Modèle de régression, taille d’effet</a></li>
<li class="chapter" data-level="3.13" data-path="3-linear-regression1.html"><a href="3-linear-regression1.html#conclusions-1"><i class="fa fa-check"></i><b>3.13</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-linear-regression2.html"><a href="4-linear-regression2.html"><i class="fa fa-check"></i><b>4</b> Modèle de régression linéaire, suite</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4-linear-regression2.html"><a href="4-linear-regression2.html#régression-multiple"><i class="fa fa-check"></i><b>4.1</b> Régression multiple</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4-linear-regression2.html"><a href="4-linear-regression2.html#associations-fortuites"><i class="fa fa-check"></i><b>4.1.1</b> Associations fortuites</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-linear-regression2.html"><a href="4-linear-regression2.html#régression-multiple-1"><i class="fa fa-check"></i><b>4.1.2</b> Régression multiple</a></li>
<li class="chapter" data-level="4.1.3" data-path="4-linear-regression2.html"><a href="4-linear-regression2.html#toujours-plus-de-prédicteurs"><i class="fa fa-check"></i><b>4.1.3</b> Toujours plus de prédicteurs</a></li>
<li class="chapter" data-level="4.1.4" data-path="4-linear-regression2.html"><a href="4-linear-regression2.html#prédicteurs-catégoriels"><i class="fa fa-check"></i><b>4.1.4</b> Prédicteurs catégoriels</a></li>
<li class="chapter" data-level="4.1.5" data-path="4-linear-regression2.html"><a href="4-linear-regression2.html#prédicteurs-catégoriels-nombre-de-catégories-3"><i class="fa fa-check"></i><b>4.1.5</b> Prédicteurs catégoriels, nombre de catégories &gt; 3</a></li>
<li class="chapter" data-level="4.1.6" data-path="4-linear-regression2.html"><a href="4-linear-regression2.html#interaction"><i class="fa fa-check"></i><b>4.1.6</b> Interaction</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Annexes</b></span></li>
<li class="chapter" data-level="A" data-path="A-glossaire.html"><a href="A-glossaire.html"><i class="fa fa-check"></i><b>A</b> Glossaire</a></li>
<li class="chapter" data-level="B" data-path="B-notations.html"><a href="B-notations.html"><i class="fa fa-check"></i><b>B</b> Notations</a></li>
<li class="chapter" data-level="" data-path="bibliographie.html"><a href="bibliographie.html"><i class="fa fa-check"></i>Bibliographie</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank"> Powered by bookdown </a></li>
<li><a href="http://www.barelysignificant.com" target="blank"> Ladislas Nalborczyk </a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours - Introduction à la modélisation statistique bayésienne</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
Ce livret est en "<b>Open Review</b>". Votre retour est essentiel afin de l'améliorer, pour vous-même ainsi que pour les futurs étudiant•e•s. Vous pouvez annoter le texte en <span style="background-color: #3297FD; color: white">le sélectionnant avec le curseur</span> et en cliquant sur l'icône <i class="h-icon-annotate"></i> dans le menu qui s'affiche en pop-up. Vous pouvez également lire les annotations des autres utilisateurs du livret en cliquant sur <i class="h-icon-chevron-left"></i> dans le coin supérieur droit de cette page.
</div>
 
<div id="linear-regression1" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapitre 3</span> Modèle de régression linéaire<a href="3-linear-regression1.html#linear-regression1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Introduction au chapitre blah blah…</p>
<div id="langage-de-la-modélisation" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Langage de la modélisation<a href="3-linear-regression1.html#langage-de-la-modélisation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
\begin{aligned}
y_{i} &amp;\sim \mathrm{Normal}(\mu_{i}, \sigma) \\
\mu_{i}&amp;= \alpha + \beta x_{i} \\
\alpha &amp;\sim \mathrm{Normal}(60, 10) \\
\beta &amp;\sim \mathrm{Normal}(0, 10) \\
\sigma &amp;\sim \mathrm{HalfCauchy}(0, 1)
\end{aligned}
\]</span></p>
<p><strong>Objectif de la séance</strong> : comprendre ce type de modèle.</p>
<p>Les constituants de nos modèles seront toujours les mêmes et nous suivrons les deux mêmes étapes :</p>
<ul>
<li>Construire le modèle (<em>likelihood</em> + <em>priors</em>).</li>
<li>Mettre à jour grâce aux données (<em>updating</em>), afin de calculer la distribution postérieure.</li>
</ul>
</div>
<div id="un-premier-modèle" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Un premier modèle<a href="3-linear-regression1.html#un-premier-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="3-linear-regression1.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb46-2"><a href="3-linear-regression1.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-3"><a href="3-linear-regression1.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="3-linear-regression1.html#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Howell1)</span>
<span id="cb46-5"><a href="3-linear-regression1.html#cb46-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Howell1</span>
<span id="cb46-6"><a href="3-linear-regression1.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    544 obs. of  4 variables:
##  $ height: num  152 140 137 157 145 ...
##  $ weight: num  47.8 36.5 31.9 53 41.3 ...
##  $ age   : num  63 63 65 41 51 35 32 27 19 54 ...
##  $ male  : int  1 0 0 1 0 1 0 1 0 1 ...</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="3-linear-regression1.html#cb48-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(age <span class="sc">&gt;=</span> <span class="dv">18</span>)</span>
<span id="cb48-2"><a href="3-linear-regression1.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d2)</span></code></pre></div>
<pre><code>##    height   weight age male
## 1 151.765 47.82561  63    1
## 2 139.700 36.48581  63    0
## 3 136.525 31.86484  65    0
## 4 156.845 53.04191  41    1
## 5 145.415 41.27687  51    0
## 6 163.830 62.99259  35    1</code></pre>
<p>…</p>
<p><span class="math display">\[h_{i} \sim \mathrm{Normal}(\mu, \sigma)\]</span></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="3-linear-regression1.html#cb50-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="3-linear-regression1.html#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height) ) <span class="sc">+</span></span>
<span id="cb50-3"><a href="3-linear-regression1.html#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="3-linear-regression1.html#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">18</span>)</span></code></pre></div>
<p><img src="IMSB_files/figure-html/unnamed-chunk-13-1.svg" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="loi-normale" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Loi normale<a href="3-linear-regression1.html#loi-normale" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
p(x \ | \ \mu, \sigma) = \frac{1}{\sqrt{2 \pi \sigma^{2}}} \exp \bigg[-\frac{1}{2 \sigma^{2}} (\mu - x)^{2} \bigg]
\]</span></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="3-linear-regression1.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">value =</span> <span class="fu">rnorm</span>(<span class="fl">1e4</span>, <span class="dv">10</span>, <span class="dv">1</span>) ) <span class="sc">%&gt;%</span> <span class="co"># 10000 samples from Normal(10, 1)</span></span>
<span id="cb51-2"><a href="3-linear-regression1.html#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value) ) <span class="sc">+</span></span>
<span id="cb51-3"><a href="3-linear-regression1.html#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">col =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="3-linear-regression1.html#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="IMSB_files/figure-html/unnamed-chunk-14-1.svg" width="75%" style="display: block; margin: auto;" /></p>
<div id="doù-vient-la-loi-normale" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> D’où vient la loi normale ?<a href="3-linear-regression1.html#doù-vient-la-loi-normale" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Certaines valeurs sont fortement probables (autour de la moyenne <span class="math inline">\(\mu\)</span>). Plus on s’éloigne, moins les valeurs sont probables (en suivant une décroissance exponentielle).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-explain1"></span>
<img src="IMSB_files/figure-html/normal-explain1-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.1: blah blah…
</p>
</div>
<p><span class="math display">\[
y = \exp \big[-x^{2} \big]
\]</span></p>
<p>On étend notre fonction aux valeurs négatives.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-explain2"></span>
<img src="IMSB_files/figure-html/normal-explain2-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.2: blah blah…
</p>
</div>
<p><span class="math display">\[
y = \exp \big[-x^{2} \big]
\]</span></p>
<p>Les points d’inflection nous donnent une bonne indication de là où la plupart des valeurs se trouvent (i.e., entre les points d’inflection). Les pics de la dérivée nous montrent les points d’inflection.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-explain3"></span>
<img src="IMSB_files/figure-html/normal-explain3-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.3: blah blah…
</p>
</div>
<p><span class="math display">\[
y = \exp \bigg [- \frac{1}{2} x^{2} \bigg]
\]</span></p>
<p>Ensuite on standardise la distribution de manière à ce que les deux points d’inflection se trouvent à <span class="math inline">\(x = -1\)</span> et <span class="math inline">\(x = 1\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-explain4"></span>
<img src="IMSB_files/figure-html/normal-explain4-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.4: blah blah…
</p>
</div>
<p><span class="math display">\[
y = \exp \bigg [- \frac{1}{2 \color{steelblue}{\sigma^{2}}} x^{2} \bigg]
\]</span></p>
<p>On insère un paramètre <span class="math inline">\(\sigma^{2}\)</span> pour contrôler la distance entre les points d’inflection.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-explain5"></span>
<img src="IMSB_files/figure-html/normal-explain5-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.5: blah blah…
</p>
</div>
<p><span class="math display">\[
y = \exp \bigg [- \frac{1}{2 \color{steelblue}{\sigma^{2}}} (x - \color{orangered}{\mu})^{2} \bigg]
\]</span></p>
<p>On insère ensuite un paramètre <span class="math inline">\(\mu\)</span> afin de pouvoir contrôler la position (la tendance centrale) de la distribution.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-explain6"></span>
<img src="IMSB_files/figure-html/normal-explain6-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.6: blah blah…
</p>
</div>
<p><span class="math display">\[
y = \frac{1}{\sqrt{2 \pi \color{steelblue}{\sigma^{2}}}} \exp \bigg[-\frac{1}{2 \color{steelblue}{\sigma^{2}}} (\color{orangered}{\mu} - x)^{2} \bigg]
\]</span></p>
<p>Mais… cette distribution n’intègre pas à 1. On divise donc par une constante de normalisation (la partie gauche), afin d’obtenir une distribution de probabilité.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-explain7"></span>
<img src="IMSB_files/figure-html/normal-explain7-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.7: blah blah…
</p>
</div>
</div>
</div>
<div id="modèle-gaussien" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Modèle gaussien<a href="3-linear-regression1.html#modèle-gaussien" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nous allons construire un modèle de régression, mais avant d’ajouter un prédicteur, essayons de modéliser la distribution des tailles.</p>
<p>On cherche à savoir quel est le modèle (la distribution) qui décrit le mieux la répartition des tailles. On va donc explorer toutes les combinaisons possibles de <span class="math inline">\(\mu\)</span> et <span class="math inline">\(\sigma\)</span> et les classer par leurs probabilités respectives.</p>
<p>Notre but, une fois encore, est de décrire <strong>la distribution postérieure</strong>, qui sera donc d’une certaine manière <strong>une distribution de distributions</strong>.</p>
<p>On définit ensuite <span class="math inline">\(p(\mu,\sigma)\)</span>, la distribution a priori conjointe de tous les paramètres du modèle. On peut spécifier ces priors indépendamment pour chaque paramètre, sachant que <span class="math inline">\(p(\mu, \sigma) = p(\mu) p(\sigma)\)</span>.</p>
<p><span class="math display">\[\color{steelblue}{\mu \sim \mathrm{Normal}(178,20)}\]</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="IMSB_files/figure-html/unnamed-chunk-15-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.8: blah blah…
</p>
</div>
<p>On définit ensuite <span class="math inline">\(p(\mu,\sigma)\)</span>, la distribution a priori conjointe de tous les paramètres du modèle. On peut spécifier ces priors indépendamment pour chaque paramètre, sachant que <span class="math inline">\(p(\mu, \sigma) = p(\mu) p(\sigma)\)</span>.</p>
<p><span class="math display">\[\color{steelblue}{\sigma \sim \mathrm{Uniform}(0,50)}\]</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-prior1"></span>
<img src="IMSB_files/figure-html/plot-prior1-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.9: blah blah…
</p>
</div>
</div>
<div id="visualiser-le-prior" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Visualiser le prior<a href="3-linear-regression1.html#visualiser-le-prior" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="3-linear-regression1.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ks)</span>
<span id="cb52-2"><a href="3-linear-regression1.html#cb52-2" aria-hidden="true" tabindex="-1"></a>sample_mu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e4</span>, <span class="dv">178</span>, <span class="dv">20</span>) <span class="co"># prior on mu</span></span>
<span id="cb52-3"><a href="3-linear-regression1.html#cb52-3" aria-hidden="true" tabindex="-1"></a>sample_sigma <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fl">1e4</span>, <span class="dv">0</span>, <span class="dv">50</span>) <span class="co"># prior on sigma</span></span>
<span id="cb52-4"><a href="3-linear-regression1.html#cb52-4" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(sample_mu, sample_sigma) ) <span class="co"># multivariate prior</span></span>
<span id="cb52-5"><a href="3-linear-regression1.html#cb52-5" aria-hidden="true" tabindex="-1"></a>H.scv <span class="ot">&lt;-</span> <span class="fu">Hscv</span>(<span class="at">x =</span> prior, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-6"><a href="3-linear-regression1.html#cb52-6" aria-hidden="true" tabindex="-1"></a>fhat_prior <span class="ot">&lt;-</span> <span class="fu">kde</span>(<span class="at">x =</span> prior, <span class="at">H =</span> H.scv, <span class="at">compute.cont =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-7"><a href="3-linear-regression1.html#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb52-8"><a href="3-linear-regression1.html#cb52-8" aria-hidden="true" tabindex="-1"></a>    fhat_prior, <span class="at">display =</span> <span class="st">&quot;persp&quot;</span>, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb52-9"><a href="3-linear-regression1.html#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">mu&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">sigma&quot;</span>, <span class="at">zlab =</span> <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">p(mu, sigma)&quot;</span>,</span>
<span id="cb52-10"><a href="3-linear-regression1.html#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">shade =</span> <span class="fl">0.8</span>, <span class="at">phi =</span> <span class="dv">30</span>, <span class="at">ticktype =</span> <span class="st">&quot;detailed&quot;</span>,</span>
<span id="cb52-11"><a href="3-linear-regression1.html#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">family =</span> <span class="st">&quot;Helvetica&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="3-linear-regression1.html#cb53-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;figures/prior.png&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-prior-2d-knitr"></span>
<img src="figures/prior.png" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.10: blah blah…
</p>
</div>
</div>
<div id="échantillonner-à-partir-du-prior" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Échantillonner à partir du prior<a href="3-linear-regression1.html#échantillonner-à-partir-du-prior" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="3-linear-regression1.html#cb54-1" aria-hidden="true" tabindex="-1"></a>sample_mu <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">178</span>, <span class="dv">20</span>)</span>
<span id="cb54-2"><a href="3-linear-regression1.html#cb54-2" aria-hidden="true" tabindex="-1"></a>sample_sigma <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb54-3"><a href="3-linear-regression1.html#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="3-linear-regression1.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, sample_mu, sample_sigma) ) <span class="sc">%&gt;%</span></span>
<span id="cb54-5"><a href="3-linear-regression1.html#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(x) ) <span class="sc">+</span></span>
<span id="cb54-6"><a href="3-linear-regression1.html#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb54-7"><a href="3-linear-regression1.html#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(y[i]) ) <span class="sc">+</span></span>
<span id="cb54-8"><a href="3-linear-regression1.html#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-prior-sigma"></span>
<img src="IMSB_files/figure-html/plot-prior-sigma-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.11: blah blah…
</p>
</div>
</div>
<div id="fonction-de-vraisemblance" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Fonction de vraisemblance<a href="3-linear-regression1.html#fonction-de-vraisemblance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="3-linear-regression1.html#cb55-1" aria-hidden="true" tabindex="-1"></a>mu_exemple <span class="ot">&lt;-</span> <span class="fl">151.23</span></span>
<span id="cb55-2"><a href="3-linear-regression1.html#cb55-2" aria-hidden="true" tabindex="-1"></a>sigma_exemple <span class="ot">&lt;-</span> <span class="fl">23.42</span></span>
<span id="cb55-3"><a href="3-linear-regression1.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="3-linear-regression1.html#cb55-4" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>height[<span class="dv">34</span>] <span class="co"># one observation</span></span></code></pre></div>
<pre><code>## [1] 162.8648</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:likelihood-plot"></span>
<img src="IMSB_files/figure-html/likelihood-plot-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.12: blah blah…
</p>
</div>
<p>On veut calculer la probabilité d’observer une certaine valeur de taille, sachant certaines valeurs de <span class="math inline">\(\mu\)</span> et <span class="math inline">\(\sigma\)</span>, c’est à dire :</p>
<p><span class="math display">\[
p(x \ | \ \mu, \sigma) = \frac{1}{\sqrt{2 \pi \sigma^{2}}} \exp \bigg[-\frac{1}{2 \sigma^{2}} (\mu - x)^{2} \bigg]
\]</span></p>
<p>On peut calculer cette <em>densité de probabilité</em> à l’aide des fonctions <code>dnorm</code>, <code>dbeta</code>, <code>dt</code>, <code>dexp</code>, <code>dgamma</code>, etc.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="3-linear-regression1.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(d2<span class="sc">$</span>height[<span class="dv">34</span>], mu_exemple, sigma_exemple)</span></code></pre></div>
<pre><code>## [1] 0.01505675</code></pre>
<p><span class="math display">\[
p(x \ | \ \mu, \sigma) = \frac{1}{\sqrt{2 \pi \sigma^{2}}} \exp \bigg[-\frac{1}{2 \sigma^{2}} (\mu - x)^{2} \bigg]
\]</span></p>
<p>Ou à la main…</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="3-linear-regression1.html#cb59-1" aria-hidden="true" tabindex="-1"></a>normal_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span> (x, mu, sigma) {</span>
<span id="cb59-2"><a href="3-linear-regression1.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-3"><a href="3-linear-regression1.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  bell <span class="ot">&lt;-</span> <span class="fu">exp</span>( (<span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>) ) <span class="sc">*</span> (mu <span class="sc">-</span> x)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb59-4"><a href="3-linear-regression1.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  norm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-5"><a href="3-linear-regression1.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-6"><a href="3-linear-regression1.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(bell <span class="sc">/</span> norm)</span>
<span id="cb59-7"><a href="3-linear-regression1.html#cb59-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-8"><a href="3-linear-regression1.html#cb59-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="3-linear-regression1.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">normal_likelihood</span>(d2<span class="sc">$</span>height[<span class="dv">34</span>], mu_exemple, sigma_exemple)</span></code></pre></div>
<pre><code>## [1] 0.01505675</code></pre>
</div>
<div id="distribution-postérieure" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Distribution postérieure<a href="3-linear-regression1.html#distribution-postérieure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
\color{purple}{p(\mu, \sigma \ | \ h)} = \frac{\prod_{i} \color{orangered}{\mathrm{Normal}(h_{i} \ | \ \mu, \sigma)}\color{steelblue}{\mathrm{Normal}(\mu \ | \ 178, 20)\mathrm{Uniform}(\sigma \ | \ 0, 50)}}
{\color{green}{\int \int \prod_{i} \mathrm{Normal}(h_{i} \ | \ \mu, \sigma)\mathrm{Normal}(\mu \ | \ 178, 20)\mathrm{Uniform}(\sigma \ | \ 0, 50) \mathrm{d} \mu \mathrm{d} \sigma}}
\]</span></p>
<p><span class="math display">\[
\color{purple}{p(\mu, \sigma \ | \ h)} \propto \prod_{i} \color{orangered}{\mathrm{Normal}(h_{i} \ | \ \mu, \sigma)}\color{steelblue}{\mathrm{Normal}(\mu \ | \ 178, 20)\mathrm{Uniform}(\sigma \ | \ 0, 50)}
\]</span></p>
<p>Il s’agit de la même formule vue lors des cours 1 et 2, mais cette fois en considérant qu’il existe plusieurs observations de taille (<span class="math inline">\(h_{i}\)</span>), et deux paramètres à estimer <span class="math inline">\(\mu\)</span> et <span class="math inline">\(\sigma\)</span>.</p>
<p>Pour calculer la <strong>vraisemblance marginale</strong> (en vert), il faut donc intégrer sur deux paramètres : <span class="math inline">\(\mu\)</span> et <span class="math inline">\(\sigma\)</span>.</p>
<p>On réalise ici encore que la probabilité a posteriori est proportionnelle au produit de la vraisemblance et du prior.</p>
<div id="distribution-postérieure---grid-approximation" class="section level3 hasAnchor" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Distribution postérieure - grid approximation<a href="3-linear-regression1.html#distribution-postérieure---grid-approximation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="3-linear-regression1.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># définit une grille de valeurs possibles pour mu et sigma</span></span>
<span id="cb62-2"><a href="3-linear-regression1.html#cb62-2" aria-hidden="true" tabindex="-1"></a>mu.list <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">140</span>, <span class="at">to =</span> <span class="dv">160</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb62-3"><a href="3-linear-regression1.html#cb62-3" aria-hidden="true" tabindex="-1"></a>sigma.list <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">4</span>, <span class="at">to =</span> <span class="dv">9</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb62-4"><a href="3-linear-regression1.html#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="3-linear-regression1.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># étend la grille en deux dimensions (chaque combinaison de mu et sigma)</span></span>
<span id="cb62-6"><a href="3-linear-regression1.html#cb62-6" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mu =</span> mu.list, <span class="at">sigma =</span> sigma.list)</span>
<span id="cb62-7"><a href="3-linear-regression1.html#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="3-linear-regression1.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># calcul de la log-vraisemblance (pour chaque couple de mu et sigma)</span></span>
<span id="cb62-9"><a href="3-linear-regression1.html#cb62-9" aria-hidden="true" tabindex="-1"></a>post<span class="sc">$</span>LL <span class="ot">&lt;-</span></span>
<span id="cb62-10"><a href="3-linear-regression1.html#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(</span>
<span id="cb62-11"><a href="3-linear-regression1.html#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(post),</span>
<span id="cb62-12"><a href="3-linear-regression1.html#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(i) <span class="fu">sum</span>(<span class="fu">dnorm</span>(</span>
<span id="cb62-13"><a href="3-linear-regression1.html#cb62-13" aria-hidden="true" tabindex="-1"></a>      d2<span class="sc">$</span>height,</span>
<span id="cb62-14"><a href="3-linear-regression1.html#cb62-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean =</span> post<span class="sc">$</span>mu[i],</span>
<span id="cb62-15"><a href="3-linear-regression1.html#cb62-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd =</span> post<span class="sc">$</span>sigma[i],</span>
<span id="cb62-16"><a href="3-linear-regression1.html#cb62-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-17"><a href="3-linear-regression1.html#cb62-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb62-18"><a href="3-linear-regression1.html#cb62-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-19"><a href="3-linear-regression1.html#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="3-linear-regression1.html#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># calcul de la probabilité a posteriori (non normalisée)</span></span>
<span id="cb62-21"><a href="3-linear-regression1.html#cb62-21" aria-hidden="true" tabindex="-1"></a>post<span class="sc">$</span>prod <span class="ot">&lt;-</span></span>
<span id="cb62-22"><a href="3-linear-regression1.html#cb62-22" aria-hidden="true" tabindex="-1"></a>  post<span class="sc">$</span>LL <span class="sc">+</span></span>
<span id="cb62-23"><a href="3-linear-regression1.html#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dnorm</span>(post<span class="sc">$</span>mu, <span class="dv">178</span>, <span class="dv">20</span>, <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb62-24"><a href="3-linear-regression1.html#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dunif</span>(post<span class="sc">$</span>sigma, <span class="dv">0</span>, <span class="dv">50</span>, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-25"><a href="3-linear-regression1.html#cb62-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-26"><a href="3-linear-regression1.html#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="co"># on &quot;annule&quot; le log en avec exp() et on standardise par la valeur maximale</span></span>
<span id="cb62-27"><a href="3-linear-regression1.html#cb62-27" aria-hidden="true" tabindex="-1"></a>post<span class="sc">$</span>prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(post<span class="sc">$</span>prod <span class="sc">-</span> <span class="fu">max</span>(post<span class="sc">$</span>prod) )</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="3-linear-regression1.html#cb63-1" aria-hidden="true" tabindex="-1"></a>sample.rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(post), <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> post<span class="sc">$</span>prob)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plotting-samples"></span>
<img src="IMSB_files/figure-html/plotting-samples-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.13: blah blah…
</p>
</div>
</div>
<div id="distribution-postérieure---distributions-marginales" class="section level3 hasAnchor" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> Distribution postérieure - distributions marginales<a href="3-linear-regression1.html#distribution-postérieure---distributions-marginales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="3-linear-regression1.html#cb64-1" aria-hidden="true" tabindex="-1"></a>BEST<span class="sc">::</span><span class="fu">plotPost</span>(</span>
<span id="cb64-2"><a href="3-linear-regression1.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  sample.mu, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(mu)</span>
<span id="cb64-3"><a href="3-linear-regression1.html#cb64-3" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="IMSB_files/figure-html/unnamed-chunk-20-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.14: blah blah…
</p>
</div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="3-linear-regression1.html#cb65-1" aria-hidden="true" tabindex="-1"></a>BEST<span class="sc">::</span><span class="fu">plotPost</span>(</span>
<span id="cb65-2"><a href="3-linear-regression1.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  sample.sigma, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(sigma)</span>
<span id="cb65-3"><a href="3-linear-regression1.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-21"></span>
<img src="IMSB_files/figure-html/unnamed-chunk-21-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.15: blah blah…
</p>
</div>
</div>
</div>
<div id="introduction-à-brms" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Introduction à brms<a href="3-linear-regression1.html#introduction-à-brms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Under the hood : <code>Stan</code> est un langage de programmation probabiliste écrit en <code>C++</code>, et qui implémente plusieurs algorithmes de MCMC: HMC, NUTS, L-BFGS…</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="3-linear-regression1.html#cb66-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb66-2"><a href="3-linear-regression1.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> J; <span class="sc">/</span><span class="er">/</span> number of schools </span>
<span id="cb66-3"><a href="3-linear-regression1.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  real y[J]; <span class="sc">/</span><span class="er">/</span> estimated treatment effects</span>
<span id="cb66-4"><a href="3-linear-regression1.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma[J]; <span class="sc">/</span><span class="er">/</span> s.e. of effect estimates </span>
<span id="cb66-5"><a href="3-linear-regression1.html#cb66-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-6"><a href="3-linear-regression1.html#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="3-linear-regression1.html#cb66-7" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb66-8"><a href="3-linear-regression1.html#cb66-8" aria-hidden="true" tabindex="-1"></a>  real mu; </span>
<span id="cb66-9"><a href="3-linear-regression1.html#cb66-9" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> tau;</span>
<span id="cb66-10"><a href="3-linear-regression1.html#cb66-10" aria-hidden="true" tabindex="-1"></a>  real eta[J];</span>
<span id="cb66-11"><a href="3-linear-regression1.html#cb66-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-12"><a href="3-linear-regression1.html#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="3-linear-regression1.html#cb66-13" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb66-14"><a href="3-linear-regression1.html#cb66-14" aria-hidden="true" tabindex="-1"></a>  real theta[J];</span>
<span id="cb66-15"><a href="3-linear-regression1.html#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>J)</span>
<span id="cb66-16"><a href="3-linear-regression1.html#cb66-16" aria-hidden="true" tabindex="-1"></a>    theta[j] <span class="ot">=</span> mu <span class="sc">+</span> tau <span class="sc">*</span> eta[j];</span>
<span id="cb66-17"><a href="3-linear-regression1.html#cb66-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-18"><a href="3-linear-regression1.html#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="3-linear-regression1.html#cb66-19" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb66-20"><a href="3-linear-regression1.html#cb66-20" aria-hidden="true" tabindex="-1"></a>  target <span class="sc">+</span><span class="er">=</span> <span class="fu">normal_lpdf</span>(eta <span class="sc">|</span> <span class="dv">0</span>, <span class="dv">1</span>);</span>
<span id="cb66-21"><a href="3-linear-regression1.html#cb66-21" aria-hidden="true" tabindex="-1"></a>  target <span class="sc">+</span><span class="er">=</span> <span class="fu">normal_lpdf</span>(y <span class="sc">|</span> theta, sigma);</span>
<span id="cb66-22"><a href="3-linear-regression1.html#cb66-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Le package <code>brms</code> (<a href="https://www.jstatsoft.org/article/view/v080i01">Bürkner, 2017</a>) permet de fitter des modèles multi-niveaux (ou pas) linéaires (ou pas) bayésiens en <code>Stan</code> mais en utilisant la syntaxe de <code>lme4</code>.</p>
<p>Par exemple, le modèle suivant :</p>
<p><span class="math display">\[
\begin{aligned}
y_{i} &amp;\sim \mathrm{Normal}(\mu_{i}, \sigma) \\
\mu_{i} &amp;= \alpha + \alpha_{subject[i]} + \alpha_{item[i]} + \beta x_{i} \\
\end{aligned}
\]</span></p>
<p>se spécifie avec <code>brms</code> (comme avec <code>lme4</code>) de la manière suivante :</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="3-linear-regression1.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">brm</span>(y <span class="sc">~</span> x <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> item), <span class="at">data =</span> d, <span class="at">family =</span> <span class="fu">gaussian</span>() )</span></code></pre></div>
<div id="rappels-de-syntaxe" class="section level3 hasAnchor" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> Rappels de syntaxe<a href="3-linear-regression1.html#rappels-de-syntaxe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le package <code>brms</code> utilise la même syntaxe que les fonctions de base R (comme <code>lm</code>) ou que le package <code>lme4</code>.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="3-linear-regression1.html#cb68-1" aria-hidden="true" tabindex="-1"></a>Reaction <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">|</span> Subject)</span></code></pre></div>
<p>La partie gauche représente notre variable dépendante (ou <em>outcome</em>, i.e., ce qu’on essaye de prédire). Le package <code>brms</code> permet également de fitter des modèles multivariés (plusieurs outcomes) en les combinant avec <code>mvbind()</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="3-linear-regression1.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mvbind</span>(Reaction, Memory) <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">|</span> Subject)</span></code></pre></div>
<p>La partie droite permet de définir les prédicteurs. L’intercept est généralement implicite, de sorte que les deux écritures ci-dessous sont équivalentes.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="3-linear-regression1.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mvbind</span>(Reaction, Memory) <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">|</span> Subject)</span>
<span id="cb70-2"><a href="3-linear-regression1.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mvbind</span>(Reaction, Memory) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">|</span> Subject)</span></code></pre></div>
<p>Si l’on veut fitter un modèle sans intercept (why not), il faut le spécifier explicitement comme ci-dessous.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="3-linear-regression1.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mvbind</span>(Reaction, Memory) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">|</span> Subject)</span></code></pre></div>
<p>Par défaut <code>brms</code> postule une vraisemblance gaussienne. Ce postulat peut être changé facilement en spécifiant la vraisemblance souhaitée via l’argument <code>family</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="3-linear-regression1.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">brm</span>(Reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">|</span> Subject), <span class="at">family =</span> <span class="fu">lognormal</span>() )</span></code></pre></div>
<p>Lisez la documentation (c’est très enthousiasmant à lire) accessible via <code>?brm</code>.</p>
</div>
<div id="quelques-fonctions-utiles" class="section level3 hasAnchor" number="3.9.2">
<h3><span class="header-section-number">3.9.2</span> Quelques fonctions utiles<a href="3-linear-regression1.html#quelques-fonctions-utiles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="3-linear-regression1.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Stan code:</span></span>
<span id="cb73-2"><a href="3-linear-regression1.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make_stancode</span>(formula, ...)</span>
<span id="cb73-3"><a href="3-linear-regression1.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stancode</span>(fit)</span>
<span id="cb73-4"><a href="3-linear-regression1.html#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="3-linear-regression1.html#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the data passed to Stan:</span></span>
<span id="cb73-6"><a href="3-linear-regression1.html#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">make_standata</span>(formula, ...)</span>
<span id="cb73-7"><a href="3-linear-regression1.html#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">standata</span>(fit)</span>
<span id="cb73-8"><a href="3-linear-regression1.html#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="3-linear-regression1.html#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle priors:</span></span>
<span id="cb73-10"><a href="3-linear-regression1.html#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(formula, ...)</span>
<span id="cb73-11"><a href="3-linear-regression1.html#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set_prior</span>(prior, ...)</span>
<span id="cb73-12"><a href="3-linear-regression1.html#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="3-linear-regression1.html#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate expected values and predictions:</span></span>
<span id="cb73-14"><a href="3-linear-regression1.html#cb73-14" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(fit, ...)</span>
<span id="cb73-15"><a href="3-linear-regression1.html#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, ...)</span>
<span id="cb73-16"><a href="3-linear-regression1.html#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="fu">marginal_effects</span>(fit, ...)</span>
<span id="cb73-17"><a href="3-linear-regression1.html#cb73-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-18"><a href="3-linear-regression1.html#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Model comparison:</span></span>
<span id="cb73-19"><a href="3-linear-regression1.html#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(fit1, fit2, ...)</span>
<span id="cb73-20"><a href="3-linear-regression1.html#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_factor</span>(fit1, fit2, ...)</span>
<span id="cb73-21"><a href="3-linear-regression1.html#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="fu">model_weights</span>(fit1, fit2, ...)</span>
<span id="cb73-22"><a href="3-linear-regression1.html#cb73-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-23"><a href="3-linear-regression1.html#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Hypothesis testing:</span></span>
<span id="cb73-24"><a href="3-linear-regression1.html#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(fit, hypothesis, ...)</span></code></pre></div>
</div>
<div id="un-premier-exemple" class="section level3 hasAnchor" number="3.9.3">
<h3><span class="header-section-number">3.9.3</span> Un premier exemple<a href="3-linear-regression1.html#un-premier-exemple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="3-linear-regression1.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb74-2"><a href="3-linear-regression1.html#cb74-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">brm</span>(height <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> d2)</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="3-linear-regression1.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">summary</span>(mod1)<span class="sc">$</span>fixed, <span class="fu">summary</span>(mod1)<span class="sc">$</span>spec_pars )</span></code></pre></div>
<pre><code>##             Estimate Est.Error   l-95% CI   u-95% CI     Rhat Bulk_ESS Tail_ESS
## Intercept 154.599646 0.4264638 153.758096 155.447157 1.001954 3354.586 2603.114
## sigma       7.759921 0.2968472   7.221742   8.365626 1.000931 3661.881 2319.010</code></pre>
<p>Ces données représentent les distributions marginales de chaque paramètre. En d’autres termes, la <em>probabilité</em> de chaque valeur de <span class="math inline">\(\mu\)</span>, après avoir <em>moyenné</em> sur toutes les valeurs possible de <span class="math inline">\(\sigma\)</span>, est décrite par une distribution gaussienne avec une moyenne de <span class="math inline">\(154.61\)</span> et un écart type de <span class="math inline">\(0.41\)</span>. L’intervalle de crédibilité (<span class="math inline">\(\neq\)</span> intervalle de confiance) nous indique les 95% valeurs de <span class="math inline">\(\mu\)</span> ou <span class="math inline">\(\sigma\)</span> les plus probables (sachant les données et les priors).</p>
</div>
<div id="en-utilisant-notre-prior" class="section level3 hasAnchor" number="3.9.4">
<h3><span class="header-section-number">3.9.4</span> En utilisant notre prior<a href="3-linear-regression1.html#en-utilisant-notre-prior" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Par défaut <code>brms</code> utilise un prior très peu informatif centré sur la valeur moyenne de la variable mesurée. On peut donc affiner l’estimation réalisée par ce modèle en utilisant nos connaissances sur la distribution habituelle des tailles chez les humains.</p>
<p>La fonction <code>get_prior()</code> permet de visualiser une liste des priors par défaut ainsi que de tous les prios qu’on peut spécifier, sachant une certaine formule (i.e., une manière d’écrire notre modèle) et un jeu de données.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="3-linear-regression1.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(height <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> d2)</span></code></pre></div>
<pre><code>##                     prior     class coef group resp dpar nlpar lb ub  source
##  student_t(3, 154.3, 8.5) Intercept                                  default
##      student_t(3, 0, 8.5)     sigma                             0    default</code></pre>
<p>…</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="3-linear-regression1.html#cb79-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb79-2"><a href="3-linear-regression1.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">20</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb79-3"><a href="3-linear-regression1.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">0.01</span>), <span class="at">class =</span> sigma)</span>
<span id="cb79-4"><a href="3-linear-regression1.html#cb79-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-5"><a href="3-linear-regression1.html#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="3-linear-regression1.html#cb79-6" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb79-7"><a href="3-linear-regression1.html#cb79-7" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb79-8"><a href="3-linear-regression1.html#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb79-9"><a href="3-linear-regression1.html#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb79-10"><a href="3-linear-regression1.html#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2</span>
<span id="cb79-11"><a href="3-linear-regression1.html#cb79-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:prior-mod2"></span>
<img src="IMSB_files/figure-html/prior-mod2-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.16: blah blah…
</p>
</div>
<p>…</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="3-linear-regression1.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: height ~ 1 
##    Data: d2 (Number of observations: 352) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   154.60      0.41   153.78   155.40 1.00     2902     2067
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     7.77      0.29     7.23     8.34 1.00     2996     2564
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="en-utilisant-un-prior-plus-informatif" class="section level3 hasAnchor" number="3.9.5">
<h3><span class="header-section-number">3.9.5</span> En utilisant un prior plus informatif<a href="3-linear-regression1.html#en-utilisant-un-prior-plus-informatif" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="3-linear-regression1.html#cb82-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb82-2"><a href="3-linear-regression1.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="fl">0.1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb82-3"><a href="3-linear-regression1.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">0.01</span>), <span class="at">class =</span> sigma)</span>
<span id="cb82-4"><a href="3-linear-regression1.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-5"><a href="3-linear-regression1.html#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="3-linear-regression1.html#cb82-6" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb82-7"><a href="3-linear-regression1.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb82-8"><a href="3-linear-regression1.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb82-9"><a href="3-linear-regression1.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb82-10"><a href="3-linear-regression1.html#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2</span>
<span id="cb82-11"><a href="3-linear-regression1.html#cb82-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:prior-mod3"></span>
<img src="IMSB_files/figure-html/prior-mod3-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.17: blah blah…
</p>
</div>
<p>…</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="3-linear-regression1.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: height ~ 1 
##    Data: d2 (Number of observations: 352) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   177.86      0.10   177.67   178.06 1.00     3212     2603
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    24.58      0.92    22.89    26.46 1.00     3687     2453
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>On remarque que la valeur estimée pour <span class="math inline">\(\mu\)</span> n’a presque pas “bougée” du prior…mais on remarque également que la valeur estimée pour <span class="math inline">\(\sigma\)</span> a largement augmentée. Nous avons dit au modèle que nous étions assez certain de notre valeur de <span class="math inline">\(\mu\)</span>, le modèle s’est ensuite “adapté”, ce qui explique la valeur de <span class="math inline">\(\sigma\)</span>…</p>
</div>
<div id="précision-du-prior-heuristique" class="section level3 hasAnchor" number="3.9.6">
<h3><span class="header-section-number">3.9.6</span> Précision du prior (heuristique)<a href="3-linear-regression1.html#précision-du-prior-heuristique" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le prior peut généralement être considéré comme un posterior obtenu sur des données antérieures.</p>
<p>On sait que le <span class="math inline">\(\sigma\)</span> d’un posterior gaussien nous est donné par la formule:</p>
<p><span class="math display">\[\sigma_{post} = 1 / \sqrt{n}\]</span></p>
<p>Qui implique une <em>quantité de données</em> <span class="math inline">\(n = 1 / \sigma^2_{post}\)</span>. Notre prior avait un <span class="math inline">\(\sigma = 0.1\)</span>, ce qui donne <span class="math inline">\(n = 1 / 0.1^2 = 100\)</span>.</p>
<p>Donc, on peut considérer que le prior <span class="math inline">\(\mu \sim \mathrm{Normal}(178, 0.1)\)</span> est équivalent au cas dans lequel nous aurions observé <span class="math inline">\(100\)</span> tailles de moyenne <span class="math inline">\(178\)</span>.</p>
</div>
<div id="récupérer-et-visualiser-les-échantillons-de-la-distribution-postérieure" class="section level3 hasAnchor" number="3.9.7">
<h3><span class="header-section-number">3.9.7</span> Récupérer et visualiser les échantillons de la distribution postérieure<a href="3-linear-regression1.html#récupérer-et-visualiser-les-échantillons-de-la-distribution-postérieure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="3-linear-regression1.html#cb85-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">posterior_samples</span>(mod2) <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="3-linear-regression1.html#cb85-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">get_density</span>(b_Intercept, sigma, <span class="at">n =</span> <span class="fl">1e2</span>) )</span>
<span id="cb85-3"><a href="3-linear-regression1.html#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="3-linear-regression1.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(post, <span class="fu">aes</span>(<span class="at">x =</span> b_Intercept, <span class="at">y =</span> sigma, <span class="at">color =</span> density) ) <span class="sc">+</span></span>
<span id="cb85-5"><a href="3-linear-regression1.html#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb85-6"><a href="3-linear-regression1.html#cb85-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb85-7"><a href="3-linear-regression1.html#cb85-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(mu), <span class="at">y =</span> <span class="fu">expression</span>(sigma) ) <span class="sc">+</span></span>
<span id="cb85-8"><a href="3-linear-regression1.html#cb85-8" aria-hidden="true" tabindex="-1"></a>    viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:samples-plot"></span>
<img src="IMSB_files/figure-html/samples-plot-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.18: blah blah…
</p>
</div>
</div>
<div id="récupérer-les-échantillons-de-la-distribution-postérieure" class="section level3 hasAnchor" number="3.9.8">
<h3><span class="header-section-number">3.9.8</span> Récupérer les échantillons de la distribution postérieure<a href="3-linear-regression1.html#récupérer-les-échantillons-de-la-distribution-postérieure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="3-linear-regression1.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gets the first 6 samples</span></span>
<span id="cb86-2"><a href="3-linear-regression1.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(post)</span></code></pre></div>
<pre><code>##   b_Intercept    sigma    lprior      lp__   density
## 1    154.4015 8.200152 -9.297956 -1227.873 0.3142422
## 2    155.1757 7.532505 -9.246354 -1227.914 0.4316129
## 3    154.9014 7.510597 -9.261880 -1227.241 0.7801206
## 4    154.4747 8.189997 -9.293538 -1227.761 0.3675453
## 5    154.7345 7.629289 -9.272738 -1226.766 1.1603879
## 6    155.0476 7.905011 -9.257408 -1227.338 0.6852718</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="3-linear-regression1.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gets the median and the 95% credible interval</span></span>
<span id="cb88-2"><a href="3-linear-regression1.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(<span class="fu">sapply</span>(post[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>) ) )</span></code></pre></div>
<pre><code>##                   2.5%        50%     97.5%
## b_Intercept 153.782212 154.605778 155.40092
## sigma         7.231156   7.759307   8.33988</code></pre>
</div>
<div id="visualiser-la-distribution-postérieure" class="section level3 hasAnchor" number="3.9.9">
<h3><span class="header-section-number">3.9.9</span> Visualiser la distribution postérieure<a href="3-linear-regression1.html#visualiser-la-distribution-postérieure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="3-linear-regression1.html#cb90-1" aria-hidden="true" tabindex="-1"></a>H.scv <span class="ot">&lt;-</span> <span class="fu">Hscv</span>(post[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb90-2"><a href="3-linear-regression1.html#cb90-2" aria-hidden="true" tabindex="-1"></a>fhat_post <span class="ot">&lt;-</span> <span class="fu">kde</span>(<span class="at">x =</span> post[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">H =</span> H.scv, <span class="at">compute.cont =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-3"><a href="3-linear-regression1.html#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="3-linear-regression1.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fhat_post, <span class="at">display =</span> <span class="st">&quot;persp&quot;</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">border =</span> <span class="cn">NA</span>,</span>
<span id="cb90-5"><a href="3-linear-regression1.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">mu&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">sigma&quot;</span>, <span class="at">zlab =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">p(mu, sigma)&quot;</span>,</span>
<span id="cb90-6"><a href="3-linear-regression1.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">shade =</span> <span class="fl">0.8</span>, <span class="at">phi =</span> <span class="dv">30</span>, <span class="at">ticktype =</span> <span class="st">&quot;detailed&quot;</span>,</span>
<span id="cb90-7"><a href="3-linear-regression1.html#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.lab =</span> <span class="fl">1.2</span>, <span class="at">family =</span> <span class="st">&quot;Helvetica&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="3-linear-regression1.html#cb91-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;figures/posterior.png&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-31"></span>
<img src="figures/posterior.png" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.19: blah blah…
</p>
</div>
</div>
<div id="visualiser-la-distribution-postérieure-1" class="section level3 hasAnchor" number="3.9.10">
<h3><span class="header-section-number">3.9.10</span> Visualiser la distribution postérieure<a href="3-linear-regression1.html#visualiser-la-distribution-postérieure-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-samples"></span>
<img src="IMSB_files/figure-html/plot-samples-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.20: blah blah…
</p>
</div>
</div>
<div id="ajouter-un-prédicteur" class="section level3 hasAnchor" number="3.9.11">
<h3><span class="header-section-number">3.9.11</span> Ajouter un prédicteur<a href="3-linear-regression1.html#ajouter-un-prédicteur" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comment est-ce que la taille co-varie avec le poids ?</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="3-linear-regression1.html#cb92-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="3-linear-regression1.html#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height) ) <span class="sc">+</span></span>
<span id="cb92-3"><a href="3-linear-regression1.html#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb92-4"><a href="3-linear-regression1.html#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:height-weight-plot"></span>
<img src="IMSB_files/figure-html/height-weight-plot-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.21: blah blah…
</p>
</div>
</div>
</div>
<div id="régression-linéaire-à-un-prédicteur-continu" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Régression linéaire à un prédicteur continu<a href="3-linear-regression1.html#régression-linéaire-à-un-prédicteur-continu" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math display">\[
\begin{aligned}
h_{i} &amp;\sim \mathrm{Normal}(\mu_{i}, \sigma) \\
\mu_{i} &amp;= \alpha + \beta x_{i} \\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="3-linear-regression1.html#cb93-1" aria-hidden="true" tabindex="-1"></a>linear_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> weight, <span class="at">data =</span> d2)</span>
<span id="cb93-2"><a href="3-linear-regression1.html#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(linear_model, <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##                    mean         sd        2.5%       97.5%
## (Intercept) 113.8793936 1.91106523 110.1337746 117.6250126
## weight        0.9050291 0.04204752   0.8226175   0.9874407</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lm-regression-plot"></span>
<img src="IMSB_files/figure-html/lm-regression-plot-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.22: blah blah…
</p>
</div>
<div id="différentes-notations-équivalentes" class="section level3 hasAnchor" number="3.10.1">
<h3><span class="header-section-number">3.10.1</span> Différentes notations équivalentes<a href="3-linear-regression1.html#différentes-notations-équivalentes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>On considère un modèle de régression linéaire avec un seul prédicteur, une pente, un intercept, et des résidus distribués selon une loi normale. La notation :</p>
<p><span class="math display">\[
h_{i} = \alpha + \beta x_{i} + \epsilon_{i} \quad \text{avec} \quad \epsilon_{i} \sim \mathrm{Normal}(0, \sigma)
\]</span></p>
<p>est équivalente à :</p>
<p><span class="math display">\[
h_{i} - (\alpha + \beta x_{i}) \sim \mathrm{Normal}(0, \sigma)
\]</span></p>
<p>et si on réduit encore un peu :</p>
<p><span class="math display">\[
h_{i} \sim \mathrm{Normal}(\alpha + \beta x_{i}, \sigma).
\]</span></p>
<p>Les notations ci-dessus sont équivalentes, mais la dernière est plus flexible, et nous permettra par la suite de l’étendre plus simplement aux modèles multi-niveaux.</p>
<p><span class="math display">\[
\begin{aligned}
\color{orangered}{h_{i}} \ &amp;\color{orangered}{\sim \mathrm{Normal}(\mu_{i},\sigma)} \\
\mu_{i} &amp;= \alpha + \beta x_{i} \\
\color{steelblue}{\alpha} \ &amp;\color{steelblue}{\sim \mathrm{Normal}(178, 20)} \\
\color{steelblue}{\beta} \ &amp;\color{steelblue}{\sim \mathrm{Normal}(0, 10)} \\
\color{steelblue}{\sigma} \ &amp;\color{steelblue}{\sim \mathrm{Exponential}(0.01)} \\
\end{aligned}
\]</span></p>
<p>Dans ce modèle <span class="math inline">\(\mu\)</span> n’est plus un paramètre à estimer (car <span class="math inline">\(\mu\)</span> est <em>déterminé</em> par <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span>). À la place, nous allons estimer <span class="math inline">\(\alpha\)</span> et <span class="math inline">\(\beta\)</span>.</p>
<p>Rappels: <span class="math inline">\(\alpha\)</span> est l’<em>intercept</em>, c’est à dire la taille attendue, lorsque le poids est égal à <span class="math inline">\(0\)</span>. <span class="math inline">\(\beta\)</span> est la pente, c’est à dire le changement de taille attendu quand le poids augmente d’une unité.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="3-linear-regression1.html#cb95-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb95-2"><a href="3-linear-regression1.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">178</span>, <span class="dv">20</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb95-3"><a href="3-linear-regression1.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb95-4"><a href="3-linear-regression1.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">0.01</span>), <span class="at">class =</span> sigma)</span>
<span id="cb95-5"><a href="3-linear-regression1.html#cb95-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-6"><a href="3-linear-regression1.html#cb95-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-7"><a href="3-linear-regression1.html#cb95-7" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb95-8"><a href="3-linear-regression1.html#cb95-8" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> weight,</span>
<span id="cb95-9"><a href="3-linear-regression1.html#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb95-10"><a href="3-linear-regression1.html#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb95-11"><a href="3-linear-regression1.html#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2</span>
<span id="cb95-12"><a href="3-linear-regression1.html#cb95-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="3-linear-regression1.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: height ~ 1 + weight 
##    Data: d2 (Number of observations: 352) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   113.95      1.90   110.23   117.70 1.00     3941     2787
## weight        0.90      0.04     0.82     0.99 1.00     3866     2713
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     5.11      0.20     4.74     5.51 1.00     3946     2967
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<ul>
<li><span class="math inline">\(\beta = 0.90, 95\% \ \text{CrI} \ [0.82, 0.99]\)</span> nous indique qu’une augmentation de 1kg entraîne une augmentation de 0.90cm.</li>
<li><span class="math inline">\(\alpha = 113.91, 95\% \ \text{CrI} \ [110.12, 117.59]\)</span> représente la taille moyenne quand le poids est égal à 0kg…</li>
</ul>
<p>…</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="3-linear-regression1.html#cb98-1" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>weight.c <span class="ot">&lt;-</span> d2<span class="sc">$</span>weight <span class="sc">-</span> <span class="fu">mean</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb98-2"><a href="3-linear-regression1.html#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="3-linear-regression1.html#cb98-3" aria-hidden="true" tabindex="-1"></a>mod5 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb98-4"><a href="3-linear-regression1.html#cb98-4" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> weight.c,</span>
<span id="cb98-5"><a href="3-linear-regression1.html#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb98-6"><a href="3-linear-regression1.html#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb98-7"><a href="3-linear-regression1.html#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d2</span>
<span id="cb98-8"><a href="3-linear-regression1.html#cb98-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="3-linear-regression1.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(mod5) <span class="co"># retrieves the fixed effects estimates</span></span></code></pre></div>
<pre><code>##              Estimate  Est.Error       Q2.5       Q97.5
## Intercept 154.6047599 0.27418324 154.071037 155.1471805
## weight.c    0.9040667 0.04174453   0.822152   0.9844688</code></pre>
<ul>
<li>Après avoir centré la réponse, l’intercept représente la valeur attendue de <em>taille</em> lorsque le poids est à sa valeur moyenne.</li>
</ul>
</div>
<div id="représenter-les-prédictions-du-modèle" class="section level3 hasAnchor" number="3.10.2">
<h3><span class="header-section-number">3.10.2</span> Représenter les prédictions du modèle<a href="3-linear-regression1.html#représenter-les-prédictions-du-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="3-linear-regression1.html#cb101-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="3-linear-regression1.html#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height) ) <span class="sc">+</span></span>
<span id="cb101-3"><a href="3-linear-regression1.html#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb101-4"><a href="3-linear-regression1.html#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">fixef</span>(mod4)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">fixef</span>(mod4)[<span class="dv">2</span>], <span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb101-5"><a href="3-linear-regression1.html#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mod4-predictions"></span>
<img src="IMSB_files/figure-html/mod4-predictions-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.23: blah blah…
</p>
</div>
</div>
<div id="représenter-lincertitude-sur-mu-via-fitted" class="section level3 hasAnchor" number="3.10.3">
<h3><span class="header-section-number">3.10.3</span> Représenter l’incertitude sur <span class="math inline">\(\mu\)</span> via fitted()<a href="3-linear-regression1.html#représenter-lincertitude-sur-mu-via-fitted" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="3-linear-regression1.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on crée un vecteur de valeurs possibles pour &quot;weight&quot;</span></span>
<span id="cb102-2"><a href="3-linear-regression1.html#cb102-2" aria-hidden="true" tabindex="-1"></a>weight.seq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">25</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="dv">1</span>) )</span>
<span id="cb102-3"><a href="3-linear-regression1.html#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="3-linear-regression1.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># on récupère les prédictions du modèle pour ces valeurs de poids</span></span>
<span id="cb102-5"><a href="3-linear-regression1.html#cb102-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">fitted</span>(mod4, <span class="at">newdata =</span> weight.seq) ) <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(weight.seq)</span>
<span id="cb102-6"><a href="3-linear-regression1.html#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="3-linear-regression1.html#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># on affiche les 10 premières lignes de mu</span></span>
<span id="cb102-8"><a href="3-linear-regression1.html#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mu, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    Estimate Est.Error     Q2.5    Q97.5 weight
## 1  136.5378 0.8810557 134.8053 138.3012     25
## 2  137.4414 0.8415178 135.7820 139.1252     26
## 3  138.3450 0.8022026 136.7638 139.9587     27
## 4  139.2486 0.7631446 137.7317 140.7903     28
## 5  140.1523 0.7243854 138.7222 141.6077     29
## 6  141.0559 0.6859756 139.6953 142.4340     30
## 7  141.9595 0.6479773 140.6758 143.2636     31
## 8  142.8631 0.6104675 141.6608 144.0954     32
## 9  143.7667 0.5735418 142.6334 144.9188     33
## 10 144.6704 0.5373209 143.6020 145.7463     34</code></pre>
<p>…</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="3-linear-regression1.html#cb104-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="3-linear-regression1.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height) ) <span class="sc">+</span></span>
<span id="cb104-3"><a href="3-linear-regression1.html#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb104-4"><a href="3-linear-regression1.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb104-5"><a href="3-linear-regression1.html#cb104-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mu, <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb104-6"><a href="3-linear-regression1.html#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb104-7"><a href="3-linear-regression1.html#cb104-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb104-8"><a href="3-linear-regression1.html#cb104-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb104-9"><a href="3-linear-regression1.html#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fitted-mod4-plot"></span>
<img src="IMSB_files/figure-html/fitted-mod4-plot-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.24: blah blah…
</p>
</div>
</div>
<div id="intervalles-de-prédiction-incorporer-sigma" class="section level3 hasAnchor" number="3.10.4">
<h3><span class="header-section-number">3.10.4</span> Intervalles de prédiction (incorporer <span class="math inline">\(\sigma\)</span>)<a href="3-linear-regression1.html#intervalles-de-prédiction-incorporer-sigma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour rappel, voici notre modèle : <span class="math inline">\(h_{i} \sim \mathrm{Normal}(\alpha + \beta x_{i}, \sigma)\)</span>. Pour l’instant, on a seulement représenté les prédictions pour <span class="math inline">\(\mu\)</span>. Comment incorporer <span class="math inline">\(\sigma\)</span> dans nos prédictions ?</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="3-linear-regression1.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on crée un vecteur de valeurs possibles pour &quot;weight&quot;</span></span>
<span id="cb105-2"><a href="3-linear-regression1.html#cb105-2" aria-hidden="true" tabindex="-1"></a>weight.seq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">weight =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">25</span>, <span class="at">to =</span> <span class="dv">70</span>, <span class="at">by =</span> <span class="dv">1</span>) )</span>
<span id="cb105-3"><a href="3-linear-regression1.html#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="3-linear-regression1.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># on récupère les prédictions du modèle pour ces valeurs de poids</span></span>
<span id="cb105-5"><a href="3-linear-regression1.html#cb105-5" aria-hidden="true" tabindex="-1"></a>pred_height <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predict</span>(mod4, <span class="at">newdata =</span> weight.seq) ) <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(weight.seq)</span>
<span id="cb105-6"><a href="3-linear-regression1.html#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="3-linear-regression1.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co"># on affiche les 10 premières lignes de pred_height</span></span>
<span id="cb105-8"><a href="3-linear-regression1.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_height, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    Estimate Est.Error     Q2.5    Q97.5 weight
## 1  136.5810  5.132924 126.3841 146.7682     25
## 2  137.5784  5.193987 127.7218 147.6821     26
## 3  138.3971  5.233652 128.2104 148.5753     27
## 4  139.4044  5.212859 129.5219 150.0878     28
## 5  140.2113  5.082795 130.4095 150.2197     29
## 6  141.0264  5.146524 130.9380 151.0698     30
## 7  142.0185  5.152701 131.8745 152.2535     31
## 8  142.8792  5.165274 132.8146 153.1452     32
## 9  143.7302  5.157094 133.3480 153.8876     33
## 10 144.7373  5.130561 134.4967 154.7412     34</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="3-linear-regression1.html#cb107-1" aria-hidden="true" tabindex="-1"></a>d2 <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="3-linear-regression1.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height) ) <span class="sc">+</span></span>
<span id="cb107-3"><a href="3-linear-regression1.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb107-4"><a href="3-linear-regression1.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb107-5"><a href="3-linear-regression1.html#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_height, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb107-6"><a href="3-linear-regression1.html#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb107-7"><a href="3-linear-regression1.html#cb107-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb107-8"><a href="3-linear-regression1.html#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb107-9"><a href="3-linear-regression1.html#cb107-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mu, <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb107-10"><a href="3-linear-regression1.html#cb107-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb107-11"><a href="3-linear-regression1.html#cb107-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb107-12"><a href="3-linear-regression1.html#cb107-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:predict-mod4-plot"></span>
<img src="IMSB_files/figure-html/predict-mod4-plot-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.25: blah blah…
</p>
</div>
</div>
<div id="deux-types-dincertitude" class="section level3 hasAnchor" number="3.10.5">
<h3><span class="header-section-number">3.10.5</span> Deux types d’incertitude<a href="3-linear-regression1.html#deux-types-dincertitude" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Deux sources d’incertitude dans le modèle : incertitude concernant l’estimation de la valeur des paramètres mais également concernant le processus d’échantillonnage.</p>
<p><strong>Incertitude épistémique</strong> : La distribution a posteriori ordonne toutes les combinaisons possibles des valeurs des paramètres selon leurs plausibilités relatives.</p>
<p><strong>Incertitude aléatoire</strong> : La distribution des données simulées est elle, une distribution qui contient de l’incertitude liée à un processus d’échantillonnage (i.e., générer des données à partir d’une gaussienne).</p>
<p>Voir aussi ce <a href="http://www.stat.columbia.edu/~gelman/stuff_for_blog/ohagan.pdf">court article</a> par O’Hagan (2012).</p>
</div>
</div>
<div id="régression-polynomiale" class="section level2 hasAnchor" number="3.11">
<h2><span class="header-section-number">3.11</span> Régression polynomiale<a href="3-linear-regression1.html#régression-polynomiale" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="3-linear-regression1.html#cb108-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="co"># on utilise d au lieu de d2</span></span>
<span id="cb108-2"><a href="3-linear-regression1.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> height) ) <span class="sc">+</span></span>
<span id="cb108-3"><a href="3-linear-regression1.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb108-4"><a href="3-linear-regression1.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-poly"></span>
<img src="IMSB_files/figure-html/plot-poly-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.26: blah blah…
</p>
</div>
<p>Si on considère tout l’échantillon (pas seulement les adultes), la relation entre taille et poids semble incurvée…</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="3-linear-regression1.html#cb109-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">weight.s =</span> (weight <span class="sc">-</span> <span class="fu">mean</span>(weight) ) <span class="sc">/</span> <span class="fu">sd</span>(weight) )</span>
<span id="cb109-2"><a href="3-linear-regression1.html#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="3-linear-regression1.html#cb109-3" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="3-linear-regression1.html#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight.s, <span class="at">y =</span> height) ) <span class="sc">+</span></span>
<span id="cb109-5"><a href="3-linear-regression1.html#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb109-6"><a href="3-linear-regression1.html#cb109-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:poly-plot-std"></span>
<img src="IMSB_files/figure-html/poly-plot-std-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.27: blah blah…
</p>
</div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="3-linear-regression1.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(d<span class="sc">$</span>weight.s), <span class="fu">sd</span>(d<span class="sc">$</span>weight.s) )</span></code></pre></div>
<pre><code>## [1] -2.712698e-18  1.000000e+00</code></pre>
<p>Pourquoi standardiser les prédicteurs ?</p>
<ul>
<li><strong>Interprétation</strong>. Un changement d’une unité du prédicteur correspond à un changement d’un écart-type sur la réponse. Permet de comparer les coefficients de plusieurs prédicteurs.</li>
<li><strong>Fitting</strong>. Quand les prédicteurs contiennent de grandes valeurs, cela peut poser des problèmes…</li>
</ul>
<div id="modèle-de-régression-polynomiale" class="section level3 hasAnchor" number="3.11.1">
<h3><span class="header-section-number">3.11.1</span> Modèle de régression polynomiale<a href="3-linear-regression1.html#modèle-de-régression-polynomiale" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{aligned}
&amp;\color{orangered}{h_{i} \sim \mathrm{Normal}(\mu_{i}, \sigma)} \\
&amp;\mu_{i} = \alpha + \beta_{1} x_{i} + \beta_{2} x_{i}^{2} \\
&amp;\color{steelblue}{\alpha \sim \mathrm{Normal}(156, 100)} \\
&amp;\color{steelblue}{\beta_{1} \sim \mathrm{Normal}(0, 10)} \\
&amp;\color{steelblue}{\beta_{2} \sim \mathrm{Normal}(0, 10)} \\
&amp;\color{steelblue}{\sigma \sim \mathrm{Exponential}(0.01)} \\
\end{aligned}
\]</span></p>
<p>À vous de construire ce modèle en utilisant <code>brms::brm()</code>…</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="3-linear-regression1.html#cb112-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb112-2"><a href="3-linear-regression1.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">156</span>, <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb112-3"><a href="3-linear-regression1.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> b),</span>
<span id="cb112-4"><a href="3-linear-regression1.html#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="fl">0.01</span>), <span class="at">class =</span> sigma)</span>
<span id="cb112-5"><a href="3-linear-regression1.html#cb112-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb112-6"><a href="3-linear-regression1.html#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="3-linear-regression1.html#cb112-7" aria-hidden="true" tabindex="-1"></a>mod6 <span class="ot">&lt;-</span> <span class="fu">brm</span>(</span>
<span id="cb112-8"><a href="3-linear-regression1.html#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># NB: polynomials should be written with the I() function...</span></span>
<span id="cb112-9"><a href="3-linear-regression1.html#cb112-9" aria-hidden="true" tabindex="-1"></a>  height <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> weight.s <span class="sc">+</span> <span class="fu">I</span>(weight.s<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb112-10"><a href="3-linear-regression1.html#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior =</span> priors,</span>
<span id="cb112-11"><a href="3-linear-regression1.html#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb112-12"><a href="3-linear-regression1.html#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> d</span>
<span id="cb112-13"><a href="3-linear-regression1.html#cb112-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="3-linear-regression1.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod6)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: height ~ 1 + weight.s + I(weight.s^2) 
##    Data: d (Number of observations: 544) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     146.67      0.37   145.95   147.40 1.00     3200     2938
## weight.s       21.40      0.29    20.82    21.95 1.00     3669     3307
## Iweight.sE2    -8.42      0.28    -8.97    -7.88 1.00     3445     3086
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     5.78      0.17     5.46     6.12 1.00     3864     2511
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>…</p>
</div>
<div id="représenter-les-prédictions-du-modèle-1" class="section level3 hasAnchor" number="3.11.2">
<h3><span class="header-section-number">3.11.2</span> Représenter les prédictions du modèle<a href="3-linear-regression1.html#représenter-les-prédictions-du-modèle-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="3-linear-regression1.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on crée un vecteur de valeurs possibles pour &quot;weight&quot;</span></span>
<span id="cb115-2"><a href="3-linear-regression1.html#cb115-2" aria-hidden="true" tabindex="-1"></a>weight.seq <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">weight.s =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">to =</span> <span class="fl">2.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>) )</span>
<span id="cb115-3"><a href="3-linear-regression1.html#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="3-linear-regression1.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># on récupère les prédictions du modèle pour ces valeurs de poids</span></span>
<span id="cb115-5"><a href="3-linear-regression1.html#cb115-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">fitted</span>(mod6, <span class="at">newdata =</span> weight.seq) ) <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(weight.seq)</span>
<span id="cb115-6"><a href="3-linear-regression1.html#cb115-6" aria-hidden="true" tabindex="-1"></a>pred_height <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predict</span>(mod6, <span class="at">newdata =</span> weight.seq) ) <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(weight.seq)</span>
<span id="cb115-7"><a href="3-linear-regression1.html#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="3-linear-regression1.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># on affiche les 10 premières lignes de pred_height</span></span>
<span id="cb115-9"><a href="3-linear-regression1.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred_height, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    Estimate Est.Error     Q2.5     Q97.5  weight.s
## 1  40.40390  5.986537 28.31332  52.08907 -2.500000
## 2  46.83829  5.968128 35.05460  58.59766 -2.397959
## 3  53.02497  5.860617 41.64739  64.10652 -2.295918
## 4  59.15998  5.869889 47.32456  70.24130 -2.193878
## 5  65.14660  5.766219 53.96058  76.36846 -2.091837
## 6  70.61914  5.755012 59.06915  82.05318 -1.989796
## 7  76.27009  5.845372 64.95498  87.65043 -1.887755
## 8  81.59569  5.704064 70.59550  92.86416 -1.785714
## 9  86.67676  5.821030 75.53530  97.99047 -1.683673
## 10 91.74770  5.875861 80.04455 102.84168 -1.581633</code></pre>
<p>…</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="3-linear-regression1.html#cb117-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="3-linear-regression1.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> weight.s, <span class="at">y =</span> height) ) <span class="sc">+</span></span>
<span id="cb117-3"><a href="3-linear-regression1.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb117-4"><a href="3-linear-regression1.html#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb117-5"><a href="3-linear-regression1.html#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> pred_height, <span class="fu">aes</span>(<span class="at">x =</span> weight.s, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb117-6"><a href="3-linear-regression1.html#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb117-7"><a href="3-linear-regression1.html#cb117-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb117-8"><a href="3-linear-regression1.html#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb117-9"><a href="3-linear-regression1.html#cb117-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mu, <span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb117-10"><a href="3-linear-regression1.html#cb117-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb117-11"><a href="3-linear-regression1.html#cb117-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb117-12"><a href="3-linear-regression1.html#cb117-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:predict-mod6-plot"></span>
<img src="IMSB_files/figure-html/predict-mod6-plot-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.28: blah blah…
</p>
</div>
</div>
</div>
<div id="modèle-de-régression-taille-deffet" class="section level2 hasAnchor" number="3.12">
<h2><span class="header-section-number">3.12</span> Modèle de régression, taille d’effet<a href="3-linear-regression1.html#modèle-de-régression-taille-deffet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Il existe plusieurs méthodes pour calculer les tailles d’effet dans les modèles bayésiens. <a href="http://www.stat.columbia.edu/~gelman/research/published/rsquared.pdf">Gelman &amp; Pardoe (2006)</a> proposent une méthode pour calculer un <span class="math inline">\(R^{2}\)</span> basé sur l’échantillon.</p>
<p><a href="http://rsos.royalsocietypublishing.org/content/4/1/160426">Marsman et al. (2017)</a>, <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/stan.12173">Marsman et al. (2019)</a> généralisent des méthodes existantes pour calculer un <span class="math inline">\(\rho^{2}\)</span> pour les designs de type ANOVA (i.e., avec prédicteurs catégoriels), qui représente une estimation de la taille d’effet <em>dans la population</em>, et non basé sur l’échantillon.</p>
<blockquote>
<p><em>“Similar to most of the ES measures that have been proposed for the ANOVA model, the squared multiple correlation coefficient <span class="math inline">\(\rho^{2}\)</span> […] is a so-called proportional reduction in error measure (PRE; Reynolds, 1977). In general, a PRE measure expresses the proportion of the variance in an outcome <span class="math inline">\(y\)</span> that is attributed to the independent variables <span class="math inline">\(x\)</span></em>” (<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/stan.12173">Marsman et al., 2019</a>).</p>
</blockquote>
<p><span class="math display">\[
\begin{aligned}
\rho^{2} &amp;= \dfrac{\sum_{i = 1}^{n} \pi_{i}(\beta_{i} - \beta)^{2}}{\sigma^{2} + \sum_{i=1}^{n} \pi_{i}(\beta_{i} - \beta)^{2}} \\  \rho^{2} &amp;= \dfrac{ \frac{1}{n} \sum_{i=1}^{n} \beta_{i}^{2}}{\sigma^{2} + \frac{1}{n} \sum_{i = 1}^{n} \beta_{i}^{2}} \\ \rho^{2} &amp;= \dfrac{\beta^{2} \tau^{2}}{\sigma^{2} + \beta^{2} \tau^{2}}\\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="3-linear-regression1.html#cb118-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">posterior_samples</span>(mod4)</span>
<span id="cb118-2"><a href="3-linear-regression1.html#cb118-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> post<span class="sc">$</span>b_weight</span>
<span id="cb118-3"><a href="3-linear-regression1.html#cb118-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> post<span class="sc">$</span>sigma</span>
<span id="cb118-4"><a href="3-linear-regression1.html#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="3-linear-regression1.html#cb118-5" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> beta<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">var</span>(d2<span class="sc">$</span>weight)</span>
<span id="cb118-6"><a href="3-linear-regression1.html#cb118-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> f1 <span class="sc">/</span> (f1 <span class="sc">+</span> sigma<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>Attention, si plusieurs prédicteurs, dépend de la structure de covariance…</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="3-linear-regression1.html#cb119-1" aria-hidden="true" tabindex="-1"></a>BEST<span class="sc">::</span><span class="fu">plotPost</span>(rho, <span class="at">showMode =</span> <span class="cn">TRUE</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(rho) )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:effsize-BEST-plot"></span>
<img src="IMSB_files/figure-html/effsize-BEST-plot-1.svg" alt="blah blah..." width="75%" />
<p class="caption">
Figure 3.29: blah blah…
</p>
</div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="3-linear-regression1.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(height <span class="sc">~</span> weight, <span class="at">data =</span> d2) )<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.5696444</code></pre>
</div>
<div id="conclusions-1" class="section level2 hasAnchor" number="3.13">
<h2><span class="header-section-number">3.13</span> Conclusions<a href="3-linear-regression1.html#conclusions-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On a présenté un nouveau modèle à deux puis trois paramètres : le modèle gaussien, puis la régression linéaire gaussienne, permettant de mettre en relation deux variables continues.</p>
<p>Comme précédemment, le théorème de Bayes est utilisé pour mettre à jour nos connaissances a priori quant à la valeur des paramètres en une connaissance a posteriori, synthèse entre nos priors et l’information contenue dans les données.</p>
<p>La package <code>brms</code> permet de fitter toutes sortes de modèles avec une syntaxe similaire à celle utilisée par <code>lm()</code>.</p>
<p>La fonction <code>fitted()</code> permet de récupérer les prédictions d’un modèle fitté avec <code>brms</code> (i.e., un modèle de classe <code>brmsfit</code>).</p>
<p>La fonction <code>predict()</code> permet de simuler des données à partir d’un modèle fitté avec <code>brms</code>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2-beta-binomial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="4-linear-regression2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/lnalborczyk/IMSB2022/_notes/doc/tree/master/03-linear-regression-part1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["IMSB.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
