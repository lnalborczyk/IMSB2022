<!DOCTYPE html>
<html lang="en"><head>
<link href="../.././files/cover.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.38">

  <meta name="author" content="Ladislas Nalborczyk (LPC, LNC, CNRS, Aix-Marseille Univ)">
  <title>IMSB2022 - Introduction à la modélisation statistique bayésienne</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #cccccc; background-color: #303030; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ffcfaf; } /* Alert */
    code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
    code span.at { } /* Attribute */
    code span.bn { color: #dca3a3; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #f0dfaf; } /* ControlFlow */
    code span.ch { color: #dca3a3; } /* Char */
    code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
    code span.co { color: #7f9f7f; } /* Comment */
    code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
    code span.do { color: #7f9f7f; } /* Documentation */
    code span.dt { color: #dfdfbf; } /* DataType */
    code span.dv { color: #dcdccc; } /* DecVal */
    code span.er { color: #c3bf9f; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #c0bed1; } /* Float */
    code span.fu { color: #efef8f; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
    code span.kw { color: #f0dfaf; } /* Keyword */
    code span.op { color: #f0efd0; } /* Operator */
    code span.ot { color: #efef8f; } /* Other */
    code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
    code span.sc { color: #dca3a3; } /* SpecialChar */
    code span.ss { color: #cc9393; } /* SpecialString */
    code span.st { color: #cc9393; } /* String */
    code span.va { } /* Variable */
    code span.vs { color: #cc9393; } /* VerbatimString */
    code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#1c5253" class="center">
  <h1 class="title">Introduction à la modélisation statistique bayésienne</h1>
  <p class="subtitle">Un cours en R, Stan, et brms</p>
  <p class="author">Ladislas Nalborczyk (LPC, LNC, CNRS, Aix-Marseille Univ)</p>
</section>

<section id="planning" class="slide level2">
<h2>Planning</h2>
<p>Cours n°01 : Introduction à l’inférence bayésienne <br> <strong>Cours n°02 : Modèle Beta-Binomial</strong> <br> Cours n°03 : Introduction à brms, modèle de régression linéaire <br> Cours n°04 : Modèle de régression linéaire (suite) <br> Cours n°05 : Markov Chain Monte Carlo <br> Cours n°06 : Modèle linéaire généralisé <br> Cours n°07 : Comparaison de modèles <br> Cours n°08 : Modèles multi-niveaux <br> Cours n°09 : Modèles multi-niveaux généralisés <br> Cours n°10 : Data Hackathon <br></p>
</section>
<section id="rappels" class="slide level2">
<h2>Rappels</h2>
<p>Principes de l’analyse bayésienne :</p>
<ul>
<li class="fragment">On dispose d’un ensemble de données à analyser</li>
<li class="fragment">On suppose un modèle génératif défini par un ensemble de paramètres</li>
<li class="fragment">On dispose d’une connaissance a priori quant à la valeur de ces paramètres</li>
</ul>
<div class="fragment">
<blockquote>
<p>The first idea is that Bayesian inference is <strong>reallocation of credibility across possibilities</strong>. The second foundational idea is that the possibilities, over which we allocate credibility, are <strong>parameter values</strong> in meaningful mathematical models <span class="citation" data-cites="kruschke2015">(<a href="#/ref-kruschke2015" role="doc-biblioref" onclick="return false;">Kruschke, 2015</a>)</span>.</p>
</blockquote>
</div>
</section>
<section id="rappels-1" class="slide level2">
<h2>Rappels</h2>
<p>Inférence bayésienne : On infère (ou plutôt on déduit) la probabilité que le paramètre ait telle ou telle valeur sachant les données (et le prior) via le théorème de Bayes.</p>
<p><span class="math display">\[
\color{purple}{p(\theta | y)} = \frac{\color{orangered}{p(y | \theta)}\ \color{steelblue}{p(\theta)}}{\color{green}{p(y)}} \propto \color{orangered}{p(y | \theta)}\ \color{steelblue}{p(\theta)}
\]</span></p>
<div class="fragment">
<p>Objectif de l’analyse de données bayésienne : Faire évoluer une connaissance a priori sur les paramètres <span class="math inline">\(\color{steelblue}{p(\theta)}\)</span> en une connaissance a posteriori <span class="math inline">\(\color{purple}{p(\theta | y)}\)</span>, intégrant l’information contenue dans les nouvelles données via <span class="math inline">\(\color{orangered}{p(y | \theta)}\)</span>.</p>
</div>
</section>
<section id="rappels-2" class="slide level2">
<h2>Rappels</h2>
<p>Les étapes de l’analyse de données bayésienne :</p>
<p><strong>1. Définir le modèle</strong> - Identifier les paramètres du modèle génératif, définir une distribution a priori pour ces paramètres.</p>
<div class="fragment">
<p><strong>2. Mettre à jour le modèle</strong> - Calculer la distribution a posteriori des paramètres (ou une bonne approximation).</p>
</div>
<div class="fragment">
<p><strong>3. Interpréter la distribution postérieure</strong> - Comparaison de modèles, estimation des paramètres, vérification des prédictions du modèle.</p>
</div>
<div class="fragment">
<p><strong>Objectif du cours</strong> : Illustrer les différentes étapes de cette démarche à l’aide d’un modèle simple (un seul paramètre), le modèle Beta-Binomial.</p>
</div>
</section>
<section id="le-modèle-beta-binomial" class="slide level2">
<h2>Le modèle Beta-Binomial</h2>
<p>Pourquoi ce modèle ?</p>
<ul>
<li class="fragment"><p>Le modèle Beta-Binomial couvre un grand nombre de problèmes de la vie courante :</p>
<ul>
<li class="fragment">Réussite / échec à un test</li>
<li class="fragment">Présence / absence d’effets secondaires lors du test d’un médicament</li>
</ul></li>
<li class="fragment"><p>C’est un modèle simple</p>
<ul>
<li class="fragment">Un seul paramètre</li>
<li class="fragment">Solution analytique</li>
</ul></li>
</ul>
</section>
<section id="loi-de-bernoulli" class="slide level2">
<h2>Loi de Bernoulli</h2>
<p>S’applique à toutes les situations où le processus de génération des données ne peut résulter qu’en deux issues mutuellement exclusives (e.g., un lancer de pièce). À chaque essai, si on admet que <span class="math inline">\(\Pr(\text{face}) = \theta\)</span>, alors <span class="math inline">\(\Pr(\text{pile}) = 1 - \theta\)</span>.</p>
<div class="fragment">
<p>Depuis Bernoulli, on sait calculer la probabilité du résultat d’un lancer de pièce, du moment que l’on connait le biais de la pièce <span class="math inline">\(\theta\)</span>. Admettons que <span class="math inline">\(Y = 0\)</span> lorsqu’on obtient pile, et que <span class="math inline">\(Y = 1\)</span> lorsqu’on obtient face. Alors <span class="math inline">\(Y\)</span> est distribuée selon une loi de Bernoulli :</p>
<p><span class="math display">\[p(y \ | \ \theta) = \Pr(Y = y \ | \ \theta) = \theta^{y} (1 - \theta)^{(1 - y)}\]</span></p>
</div>
<div class="fragment">
<p>En remplaçant <span class="math inline">\(y\)</span> par <span class="math inline">\(0\)</span> ou <span class="math inline">\(1\)</span>, on retombe bien sur nos observations précédentes :</p>
<p><span class="math display">\[\Pr(Y = 1 \ | \ \theta) = \theta^{1} (1 - \theta)^{(1 - 1)} = \theta \times 1 = \theta\]</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[\Pr(Y = 0 \ | \ \theta) = \theta^{0} (1 - \theta)^{(1 - 0)} = 1 \times (1 - \theta) = 1 - \theta\]</span></p>
</div>
</section>
<section id="schéma-de-bernoulli" class="slide level2">
<h2>Schéma de Bernoulli</h2>
<p>Si l’on dispose d’une suite de lancers <span class="math inline">\(\{Y_i\}\)</span> indépendants et identiquement distribués (i.e., chaque lancer a une distribution de Bernoulli de probabilité <span class="math inline">\(\theta\)</span>), l’ensemble de ces lancers peut être décrit par une <strong>distribution binomiale</strong>.</p>
<div class="fragment">
<p>Par exemple, imaginons que l’on dispose de la séquence de cinq lancers suivants : Pile, Pile, Pile, Face, Face. On peut recoder cette séquence en <span class="math inline">\(\{0, 0, 0, 1, 1\}\)</span>.</p>
<p>Rappel : La probabilité de chaque <span class="math inline">\(1\)</span> est <span class="math inline">\(\theta\)</span> est la probabilité de chaque <span class="math inline">\(0\)</span> est <span class="math inline">\(1 - \theta\)</span>.</p>
<p>Quelle est la probabilité d’obtenir 2 faces sur 5 lancers ?</p>
</div>
</section>
<section id="schéma-de-bernoulli-1" class="slide level2">
<h2>Schéma de Bernoulli</h2>
<p>Sachant que les essais sont indépendants les uns des autres, la probabilité d’obtenir cette séquence est de <span class="math inline">\((1 - \theta) \times (1 - \theta) \times (1 - \theta) \times \theta \times \theta\)</span>, c’est à dire : <span class="math inline">\(\theta^{2} (1 - \theta)^{3}\)</span>.</p>
<div class="fragment">
<p>On peut généraliser ce résultat pour une séquence de <span class="math inline">\(n\)</span> lancers et <span class="math inline">\(y\)</span> “succès” :</p>
<p><span class="math display">\[\theta^{y} (1 - \theta)^{n - y}\]</span></p>
</div>
<div class="fragment">
<p>Mais, jusque là on a considéré seulement une seule séquence résultant en 2 succès pour 5 lancers, mais il existe de nombreuses séquences pouvant résulter en 2 succès pour 5 lancers (e.g., <span class="math inline">\(\{0, 0, 1, 0, 1\}\)</span>, <span class="math inline">\(\{0, 1, 1, 0, 0\}\)</span>)…</p>
</div>
</section>
<section id="coefficient-binomial" class="slide level2">
<h2>Coefficient binomial</h2>
<p>Le <strong>coefficient binomial</strong> nous permet de calculer le nombre de combinaisons possibles résultant en <span class="math inline">\(y\)</span> succès pour <span class="math inline">\(n\)</span> lancers de la manière suivante (lu “<span class="math inline">\(y\)</span> parmi <span class="math inline">\(n\)</span>” ou “nombre de combinaisons de <span class="math inline">\(y\)</span> parmi <span class="math inline">\(n\)</span>”) :</p>
<p><span class="math display">\[
\left(\begin{array}{l} n \\ y \end{array}\right) = C_{n}^{y} = \frac{n !}{y !(n - y) !}
\]</span></p>
<div class="fragment">
<p>Par exemple pour <span class="math inline">\(y = 1\)</span> et <span class="math inline">\(n = 3\)</span>, on sait qu’il existe 3 combinaisons possibles : <span class="math inline">\(\{0, 0, 1\}, \{0, 1, 0\}, \{1, 0, 0\}\)</span>. On peut vérifier ça par le calcul, en appliquant la formule ci-dessus.</p>
<p><span class="math display">\[
\left(\begin{array}{l} 3 \\ 1\end{array}\right) = C_{1}^{3} = \frac{3 !}{1 !(3 - 1) !} = \frac{3 \times 2 \times 1}{1 \times 2 \times 1} = \frac{6}{2} = 3
\]</span></p>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/binomialcoef_8396bb1b0fb107a039329fedc46a698a">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># computing the total number of possible configurations in R</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">choose</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">k =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-layout-align="center" data-hash="Cours02_cache/revealjs/binomialcoef_8396bb1b0fb107a039329fedc46a698a">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
</section>
<section id="loi-binomiale" class="slide level2">
<h2>Loi binomiale</h2>
<p><span class="math display">\[p(y \ | \ \theta) = \Pr(Y = y \ | \ \theta) = \left(\begin{array}{l} n \\ y \end{array}\right) \theta^{y}(1 - \theta)^{n - y}\]</span></p>
<p>La loi binomiale nous permet de calculer la probabilité d’obtenir <span class="math inline">\(y\)</span> succès sur <span class="math inline">\(n\)</span> essais, pour un <span class="math inline">\(\theta\)</span> donné. Exemple de la distribution binomiale pour une pièce non biaisée (<span class="math inline">\(\theta = 0.5\)</span>), indiquant la probabilité d’obtenir <span class="math inline">\(n\)</span> faces sur 10 lancers (en R: <code>dbinom(x = 0:10, size = 10, prob = 0.5)</code>).</p>

<img data-src="Cours02_files/figure-revealjs/unnamed-chunk-1-1.svg" width="720" class="r-stretch quarto-figure-center"></section>
<section id="générer-des-données-à-partir-dune-distribution-binomiale" class="slide level2">
<h2>Générer des données à partir d’une distribution binomiale</h2>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/berndata_4bf4ccc37c76d654facd63499d7f4cfd">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">set.seed</span>(<span class="dv">666</span>) <span class="co"># for reproducibility</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">500</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.6</span>) <span class="sc">%&gt;%</span> <span class="co"># theta = 0.6</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>        data.frame <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>        <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">seq_along</span>(.), <span class="at">y =</span> <span class="fu">cumsum</span>(.) <span class="sc">/</span> <span class="fu">seq_along</span>(.) ) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">log =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>        <span class="fu">geom_line</span>(<span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.6</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Nombre de lancers"</span>, <span class="at">y =</span> <span class="st">"Proportion de faces"</span>) <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>        <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Cours02_files/figure-revealjs/berndata-1.svg" style="width:50.0%" class="r-stretch quarto-figure-center"></section>
<section id="définition-du-modèle-likelihood" class="slide level2">
<h2>Définition du modèle (likelihood)</h2>
<p>Fonction de vraisemblance (likelihood)</p>
<ul>
<li class="fragment">Nous considérons <span class="math inline">\(y\)</span> comme étant le nombre de succès</li>
<li class="fragment">Nous considérons le nombre d’observations <span class="math inline">\(n\)</span> comme étant une <strong>constante</strong></li>
<li class="fragment">Nous considérons <span class="math inline">\(\theta\)</span> comme étant le <strong>paramètre</strong> de notre modèle (i.e., la probabilité de succès)</li>
</ul>
<div class="fragment">
<p>La fonction de vraisemblance s’écrit de la manière suivante :</p>
<p><span class="math display">\[
\color{orangered}{\mathcal{L}(\theta\ |\ y, n) = p(y \ |\ \theta, n) = \left(\begin{array}{l} n \\ y \end{array}\right) \theta^{y}(1 - \theta)^{n - y} \propto \theta^{y}(1 - \theta)^{n - y}}
\]</span></p>
</div>
</section>
<section id="vraisemblance-versus-probabilité" class="slide level2">
<h2>Vraisemblance versus probabilité</h2>
<p>On lance à nouveau une pièce de biais <span class="math inline">\(\theta\)</span> (où <span class="math inline">\(\theta\)</span> représente la probabilité d’obtenir Face). On lance cette pièce deux fois et on obtient une Face et un Pile.</p>
<div class="fragment">
<p>On peut calculer la probabilité de ces données selon (i.e., <em>en fonction de</em>) différentes valeurs de <span class="math inline">\(\theta\)</span> de la manière suivante :</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(F, P \ | \ \theta) + \Pr(P, F \ | \ \theta) &amp;= 2 \times \Pr(P \ | \ \theta) \times \Pr(F \ | \ \theta) \\
&amp;= \theta(1 - \theta) + \theta(1 - \theta) \\
&amp;= 2 \theta(1 - \theta)
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<p>Cette probabilité est définie pour un jeu de données fixe et une valeur de <span class="math inline">\(\theta\)</span> variable. On peut représenter cette fonction visuellement.</p>
</div>
</section>
<section id="vraisemblance-versus-probabilité-1" class="slide level2">
<h2>Vraisemblance versus probabilité</h2>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/likelihood_af5f39d6fcdbaf4c967a513c71a5793e">
<div class="sourceCode cell-code" id="cb4" data-code-line-numbers="|7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Représentation graphique de la fonction de vraisemblance de theta pour y = 1 et n = 2</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># nombre de faces</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>n <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># nombre d'essais</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="fu">data.frame</span>(<span class="at">theta =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="fl">1e3</span>) ) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="at">x =</span> y, <span class="at">size =</span> n, <span class="at">prob =</span> theta) ) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> likelihood) ) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="fu">geom_area</span>(<span class="at">color =</span> <span class="st">"orangered"</span>, <span class="at">fill =</span> <span class="st">"orangered"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(theta, <span class="st">" - Pr(face)"</span>) ) ) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Likelihod"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Cours02_files/figure-revealjs/likelihood-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="vraisemblance-versus-probabilité-2" class="slide level2">
<h2>Vraisemblance versus probabilité</h2>
<p>Si on calcule l’aire sous la courbe de cette fonction, on obtient :</p>
<p><span class="math display">\[\int_{0}^{1} 2 \theta(1 - \theta) \mathrm{d} \theta = \frac{1}{3}\]</span></p>
<div class="fragment">
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-2_11cfb19302a85d7331ca00a355583f1e">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) {<span class="dv">2</span> <span class="sc">*</span> theta <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta) }</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">integrate</span>(<span class="at">f =</span> f, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.3333333 with absolute error &lt; 3.7e-15</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Quand on varie <span class="math inline">\(\theta\)</span>, la fonction de vraisemblance <em>n’est pas</em> une distribution de probabilité valide (i.e., son intégrale n’est pas égale à 1). On utilise le terme de <strong>vraisemblance</strong>, pour distinguer ce type de fonction des fonctions de densité de probabilité. On utilise la notation suivante pour mettre l’accent sur le fait que la fonction de vraisemblance est une fonction de <span class="math inline">\(\theta\)</span>, et que les données sont fixes : <span class="math inline">\(\mathcal{L}(\theta \ | \ data) = p(data \ | \ \theta)\)</span>.</p>
</div>
</section>
<section id="vraisemblance-versus-probabilité-3" class="slide level2">
<h2>Vraisemblance versus probabilité</h2>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-3_73642ffd0b7bd2a10c39ad822aee2719">
<div class="cell-output-display">

<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>Probabilité vs. vraisemblance pour deux lancers de pièce</caption>
 <thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1"></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Nombre de Faces (y)</div></th>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1"></th>
</tr>
  <tr>
   <th style="text-align:center;"> theta </th>
   <th style="text-align:center;"> 0 </th>
   <th style="text-align:center;"> 1 </th>
   <th style="text-align:center;"> 2 </th>
   <th style="text-align:center;"> Total </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> 1.00 </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 0.2 </td>
   <td style="text-align:center;"> 0.64 </td>
   <td style="text-align:center;"> 0.32 </td>
   <td style="text-align:center;"> 0.04 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 0.4 </td>
   <td style="text-align:center;"> 0.36 </td>
   <td style="text-align:center;"> 0.48 </td>
   <td style="text-align:center;"> 0.16 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 0.6 </td>
   <td style="text-align:center;"> 0.16 </td>
   <td style="text-align:center;"> 0.48 </td>
   <td style="text-align:center;"> 0.36 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 0.8 </td>
   <td style="text-align:center;"> 0.04 </td>
   <td style="text-align:center;"> 0.32 </td>
   <td style="text-align:center;"> 0.64 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 1.00 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Total </td>
   <td style="text-align:center;"> 2.20 </td>
   <td style="text-align:center;"> 1.60 </td>
   <td style="text-align:center;"> 2.20 </td>
   <td style="text-align:center;">  </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Notons que la vraisemblance de <span class="math inline">\(\theta\)</span> pour une donnée particulière est égale à la probabilité de cette donnée pour cette valeur de <span class="math inline">\(\theta\)</span>. Cependant, la <em>distribution</em> de ces vraisemblances (en colonne) n’est pas une distribution de probabilité. Dans l’analyse bayésienne, <strong>les données sont considérées comme fixes</strong> et la valeur de <span class="math inline">\(\theta\)</span> est considérée comme une <strong>variable aléatoire</strong>.</p>
</section>
<section id="définition-du-modèle-prior" class="slide level2">
<h2>Définition du modèle (prior)</h2>
<p>Comment définir un prior dans le cas du lancer de pièce ?</p>
<div class="fragment">
<p><strong>Aspect sémantique</strong> <span class="math inline">\(~\rightarrow~\)</span> <em>le prior doit pouvoir rendre compte</em> :</p>
<ul>
<li class="fragment">D’une absence d’information</li>
<li class="fragment">D’une connaissance d’observations antérieures concernant la pièce étudiée</li>
<li class="fragment">D’un niveau d’incertitude concernant ces observations antérieures</li>
</ul>
</div>
<div class="fragment">
<p><strong>Aspect mathématique</strong> <span class="math inline">\(~\rightarrow~\)</span> <em>pour une solution entièrement analytique</em> :</p>
<ul>
<li class="fragment">Les distributions a priori et a posteriori doivent avoir la même forme</li>
<li class="fragment">La vraisemblance marginale doit pouvoir se calculer analytiquement</li>
</ul>
</div>
</section>
<section id="la-distribution-beta" class="slide level2">
<h2>La distribution Beta</h2>
<p><span class="math display">\[
\begin{align}
\color{steelblue}{p(\theta\ | \ a, b)} \ &amp;\color{steelblue}{= \mathrm{Beta}(\theta\ |\ a, b)} \\
&amp; \color{steelblue}{= \theta^{a - 1}(1 - \theta)^{b - 1} / B(a, b)} \\
&amp; \color{steelblue}{\propto \theta^{a - 1}(1 - \theta)^{b - 1}}
\end{align}
\]</span></p>
<p>où <span class="math inline">\(a\)</span> et <span class="math inline">\(b\)</span> sont deux paramètres tels que <span class="math inline">\(a \geq 0\)</span>, <span class="math inline">\(b \geq 0\)</span>, et <span class="math inline">\(B(a, b)\)</span> est une constante de normalisation.</p>

<img data-src="Cours02_files/figure-revealjs/beta1-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="interprétation-des-paramètres-du-prior-beta" class="slide level2">
<h2>Interprétation des paramètres du prior Beta</h2>
<ul>
<li class="fragment">On peut exprimer l’absence de connaissance a priori par <span class="math inline">\(a = b = 1\)</span> (distribution orange).</li>
<li class="fragment">On peut exprimer un prior en faveur d’une absence de biais par <span class="math inline">\(a = b \geq 2\)</span> (distribution verte).</li>
<li class="fragment">On peut exprimer un biais en faveur de <em>Face</em> par <span class="math inline">\(a &gt; b\)</span> (distribution bleue).</li>
<li class="fragment">On peut exprimer un biais en faveur de <em>Pile</em> par <span class="math inline">\(a &lt; b\)</span> (distribution violette).</li>
</ul>

<img data-src="Cours02_files/figure-revealjs/beta2-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="interprétation-des-paramètres-du-prior-beta-1" class="slide level2">
<h2>Interprétation des paramètres du prior Beta</h2>
<p>Le niveau de certitude augmente avec la somme <span class="math inline">\(\kappa = a + b\)</span>.</p>
<ul>
<li class="fragment">Aucune idée sur la provenance de la pièce : <span class="math inline">\(a = b = 1\)</span> -&gt; <strong>prior plat</strong>.</li>
<li class="fragment">En attendant le début de l’expérience, on a lancé la pièce 10 fois et observé 5 “Face” : <span class="math inline">\(a = b = 5\)</span> -&gt; <strong>prior peu informatif</strong>.</li>
<li class="fragment">La pièce provient de la banque de France : <span class="math inline">\(a = b = 50\)</span> -&gt; <strong>prior fort</strong>.</li>
</ul>

<img data-src="Cours02_files/figure-revealjs/beta3-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="interprétation-des-paramètres-du-prior-beta-2" class="slide level2">
<h2>Interprétation des paramètres du prior Beta</h2>
<p>Supposons que l’on dispose d’une estimation de la valeur la plus probable <span class="math inline">\(\omega\)</span> du paramètre <span class="math inline">\(\theta\)</span>. On peut reparamétriser la distribution Beta en fonction du mode <span class="math inline">\(\omega\)</span> et du niveau de certitude <span class="math inline">\(\kappa\)</span> :</p>
<p><span class="math display">\[
\begin{align}
a &amp;= \omega(\kappa - 2) + 1 \\
b &amp;= (1 - \omega)(\kappa - 2) + 1 &amp;&amp;\mbox{pour } \kappa &gt; 2
\end{align}
\]</span></p>
<div class="fragment">
<p>Si <span class="math inline">\(\omega = 0.65\)</span> et <span class="math inline">\(\kappa = 25\)</span> alors <span class="math inline">\(p(\theta) = \mathrm{Beta}(\theta \ | \ 15.95, 9.05)\)</span>. <br> Si <span class="math inline">\(\omega = 0.65\)</span> et <span class="math inline">\(\kappa = 10\)</span> alors <span class="math inline">\(p(\theta) = \mathrm{Beta}(\theta \ | \ 6.2, 3.8)\)</span>.</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/beta4_77b2830bb3da853b187264589d73675b">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Cours02_files/figure-revealjs/beta4-1.svg" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="prior-conjugué" class="slide level2">
<h2>Prior conjugué</h2>
<p>Formellement, si <span class="math inline">\(\mathcal{F}\)</span> est une classe de distributions d’échantillonnage <span class="math inline">\(p(y|\theta)\)</span>, et <span class="math inline">\(\mathcal{P}\)</span> est une classe de distributions a priori pour <span class="math inline">\(\theta\)</span>, alors <span class="math inline">\(\mathcal{P}\)</span> est <strong>conjuguée</strong> à <span class="math inline">\(\mathcal{F}\)</span> si et seulement si :</p>
<p><span class="math display">\[
p(\theta|y) \in \mathcal{P} \text{ for all } p(\cdot | \theta) \in \mathcal{F} \text{ and } p(\cdot) \in \mathcal{P}
\]</span></p>
<p>(Gelman et al., 2013, p.35). En d’autres termes, un prior est appelé <strong>conjugué</strong> si, lorsqu’il est converti en une distribution a posteriori en étant multiplié par la fonction de vraisemblance, il conserve la même forme. Dans notre cas, le prior Beta est un prior conjugué pour la vraisemblance binomiale, car le posterior est également une distribution Beta.</p>
<div class="fragment">
<blockquote>
<p>Le résultat du produit d’un prior Beta et d’une fonction de vraisemblance Binomiale est proportionnel à une distribution Beta. On dit alors que la distribution Beta est <strong>un prior conjugué</strong> de la fonction de vraisemblance Binomiale.</p>
</blockquote>
</div>
</section>
<section id="dérivation-analytique-de-la-distribution-a-posteriori" class="slide level2">
<h2>Dérivation analytique de la distribution a posteriori</h2>
<p>Soit un prior défini par : <span class="math inline">\(\ \color{steelblue}{p(\theta \ | \ a, b) = \mathrm{Beta}(a, b) \propto \theta^{a - 1}(1 - \theta)^{b - 1}}\)</span></p>
<div class="fragment">
<p>Soit une fonction de vraisemblance associée à <span class="math inline">\(y\)</span> “Face” pour <span class="math inline">\(n\)</span> lancers : <span class="math inline">\(\ \color{orangered}{p(y \ | \ n, \theta) = \mathrm{Bin}(y \ | \ n, \theta) = \left(\begin{array}{l} n \\ y \end{array}\right) \theta^{y}(1 - \theta)^{n - y} \propto \theta^{y}(1 - \theta)^{n - y}}\)</span></p>
</div>
<div class="fragment">
<p><span class="math display">\[
\begin{align}
\color{purple}{p(\theta \ | \ y, n)} &amp;\propto \color{orangered}{p(y \ | \ n, \theta)} \ \color{steelblue}{p(\theta)} &amp;&amp;\mbox{Théorème de Bayes} \\
&amp;\propto \color{orangered}{\mathrm{Bin}(y \ | \ n, \theta)} \ \color{steelblue}{\mathrm{Beta}(\theta \ | \ a, b)} \\
&amp;\propto \color{orangered}{\theta^{y}(1 - \theta)^{n - y}} \ \color{steelblue}{\theta^{a - 1}(1 - \theta)^{b - 1}} &amp;&amp;\mbox{Application des formules précédentes} \\
&amp;\propto \color{purple}{\theta}^{\color{orangered}{y} + \color{steelblue}{a - 1}}\color{purple}{(1 - \theta)}^{\color{orangered}{n - y} + \color{steelblue}{b - 1}} &amp;&amp;\mbox{En regroupant les termes identiques} \\
&amp;\propto \color{purple}{\theta^{a' - 1}(1 - \theta)^{b' - 1}} &amp;&amp;\mbox{Avec } a' = y + a \mbox{ et } b' = n - y + b \\
\color{purple}{p(\theta \ | \ y, n)} \ &amp;= \color{purple}{\mathrm{Beta}(y + a, n - y + b)}
\end{align}
\]</span></p>
</div>
</section>
<section id="un-exemple-pour-digérer" class="slide level2">
<h2>Un exemple pour digérer</h2>
<p>On observe <span class="math inline">\(y = 7\)</span> réponses correctes sur <span class="math inline">\(n = 10\)</span> questions. On choisit un prior <span class="math inline">\(\mathrm{Beta}(1, 1)\)</span>, c’est à dire un prior uniforme sur <span class="math inline">\([0, 1]\)</span>. Ce prior équivaut à une connaissance a priori de 0 succès et 0 échecs (i.e., prior plat).</p>
<div class="fragment">
<p>La distribution postérieure est donnée par :</p>
<p><span class="math display">\[
\begin{align}
\color{purple}{p(\theta \ | \ y, n)} &amp;\propto \color{orangered}{p(y \ | \ n, \theta)} \ \color{steelblue}{p(\theta)} \\
&amp;\propto \color{orangered}{\mathrm{Bin}(7 \ | \ 10, \theta)} \ \color{steelblue}{\mathrm{Beta}(\theta \ | \ 1, 1)} \\
&amp;= \color{purple}{\mathrm{Beta}(y + a, n - y + b)} \\
&amp;= \color{purple}{\mathrm{Beta}(8, 4)}
\end{align}
\]</span></p>
</div>
<div class="fragment">
<p>La moyenne de la distribution postérieure est donnée par :</p>
<p><span class="math display">\[
\color{purple}{\underbrace{\frac{y + a}{n + a + b}}_{posterior}} = \color{orangered}{\underbrace{\frac{y}{n}}_{data}} \underbrace{\frac{n}{n + a + b}}_{weight} + \color{steelblue}{\underbrace{\frac{a}{a + b}}_{prior}} \underbrace{\frac{a + b}{n + a + b}}_{weight}
\]</span></p>
</div>
</section>
<section id="un-exemple-pour-digérer-1" class="slide level2">
<h2>Un exemple pour digérer</h2>

<img data-src="Cours02_files/figure-revealjs/beta-exemple-1.svg" width="864" class="r-stretch quarto-figure-center"></section>
<section id="influence-du-prior-sur-la-distribution-postérieure" class="slide level2">
<h2>Influence du prior sur la distribution postérieure</h2>
<p>Cas <span class="math inline">\(n &lt; a + b, (n = 10, a = 4, b = 16)\)</span>.</p>

<img data-src="Cours02_files/figure-revealjs/posterior-exemple1-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="influence-du-prior-sur-la-distribution-postérieure-1" class="slide level2">
<h2>Influence du prior sur la distribution postérieure</h2>
<p>Cas <span class="math inline">\(n = a + b, (n = 20, a = 4, b = 16)\)</span>.</p>

<img data-src="Cours02_files/figure-revealjs/posterior-exemple2-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="influence-du-prior-sur-la-distribution-postérieure-2" class="slide level2">
<h2>Influence du prior sur la distribution postérieure</h2>
<p>Cas <span class="math inline">\(n &gt; a + b, (n = 40, a = 4, b = 16)\)</span>.</p>

<img data-src="Cours02_files/figure-revealjs/posterior-exemple3-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="ce-quil-faut-retenir" class="slide level2">
<h2>Ce qu’il faut retenir</h2>
<blockquote>
<p>The posterior distribution is always a compromise between the prior distribution and the likelihood function <span class="citation" data-cites="kruschke2015">(<a href="#/ref-kruschke2015" role="doc-biblioref" onclick="return false;">Kruschke, 2015</a>)</span>.</p>
</blockquote>

<img data-src="Cours02_files/figure-revealjs/posterior-exemple4-1.svg" width="1344" class="r-stretch quarto-figure-center"></section>
<section id="ce-quil-faut-retenir-1" class="slide level2">
<h2>Ce qu’il faut retenir</h2>
<p>Plus on a de données, moins le prior a d’influence dans l’estimation de la distribution a posteriori (et réciproquement). <strong>Attention :</strong> Lorsque le prior accorde une probabilité de 0 à certaines valeurs de <span class="math inline">\(\theta\)</span>, le modèle est incapable d’apprendre (ces valeurs sont alors considérées comme “impossibles”)…</p>

<img data-src="Cours02_files/figure-revealjs/posterior-exemple5-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="la-vraisemblance-marginale" class="slide level2">
<h2>La vraisemblance marginale</h2>
<p><span class="math display">\[
\text{Posterior} = \frac{\text{Likelihood} \times \text{Prior}}{\text{Marginal likelihood}} \propto \text{Likelihood} \times \text{Prior}
\]</span></p>
<p><span class="math display">\[
p(\theta | \text{data}) = \frac{p(\text{data} | \theta) \times \ p(\theta)}{p(\text{data})} \propto p(\text{data} | \theta) \times p(\theta)
\]</span></p>
<div class="fragment">
<p>Si on zoom sur la vraisemblance marginale (aussi connue comme <em>evidence</em>)…</p>
<p><span class="math display">\[
\begin{align}
\color{green}{p(\text{data})} &amp;= \int p(\text{data}, \theta) \, \mathrm d\theta &amp;&amp;\mbox{Marginalisation sur le paramètre } \theta \\
\color{green}{p(\text{data})} &amp;= \color{green}{\int p(\text{data} | \theta) \times p(\theta) \, \mathrm{d} \theta} &amp;&amp; \mbox{Application de la règle du produit}
\end{align}
\]</span></p>
</div>
</section>
<section id="la-vraisemblance-marginale-1" class="slide level2">
<h2>La vraisemblance marginale</h2>
<p>Petit problème : <span class="math inline">\(p(\text{data})\)</span> s’obtient en calculant la somme (pour des variables discrètes) ou l’intégrale (pour des variables continues) de la densité conjointe <span class="math inline">\(p(\text{data}, \theta)\)</span> sur toutes les valeurs possibles de <span class="math inline">\(\theta\)</span>. Cela se complique lorsque le modèle comprend plusieurs paramètres continus…</p>
<div class="fragment">
<p>Par exemple pour deux paramètres discrets :</p>
<p><span class="math display">\[
p(\text{data}) = \sum_{\theta_{1}} \sum_{\theta_{2}} p(\text{data}, \theta_{1}, \theta_{2})
\]</span></p>
</div>
<div class="fragment">
<p>Et pour un modèle avec deux paramètres continus :</p>
<p><span class="math display">\[
p(\text{data}) = \int\limits_{\theta_{1}} \int\limits_{\theta_{2}} p(\text{data}, \theta_{1}, \theta_{2}) \mathrm{d} \theta_{1} \mathrm{d} \theta_{2}
\]</span></p>
</div>
</section>
<section id="la-vraisemblance-marginale-2" class="slide level2">
<h2>La vraisemblance marginale</h2>
<p>Trois méthodes pour résoudre (contourner) ce problème :</p>
<ul>
<li class="fragment"><p>Solution analytique <span class="math inline">\(\longrightarrow\)</span> Utilisation d’un prior conjugué (e.g., le modèle Beta-Binomial).</p></li>
<li class="fragment"><p>Solution discrétisée <span class="math inline">\(\longrightarrow\)</span> Calcul de la solution sur un ensemble fini de points (grid method).</p></li>
<li class="fragment"><p>Solution approchée <span class="math inline">\(\longrightarrow\)</span> On échantillonne “intelligemment” l’espace conjoint des paramètres (e.g., méthodes MCMC, Cours n°05).</p></li>
</ul>
</section>
<section id="distributions-discrètes" class="slide level2">
<h2>Distributions discrètes</h2>

<img data-src="figures/discrete.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="distributions-continues" class="slide level2">
<h2>Distributions continues</h2>

<img data-src="figures/continuous.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p>Problème : Cette solution est très contraignante. Idéalement, le modèle (likelihood + prior) devrait être défini à partir de l’interprétation que l’on peut faire des paramètres de ces distributions, et non pour faciliter les calculs…</p>
</section>
<section id="la-distribution-postérieure-grid-method" class="slide level2">
<h2>La distribution postérieure, grid method</h2>
<div>
<ul>
<li><strong>Définir la grille</strong></li>
<li>Calculer la valeur du prior pour chaque valeur de la grille</li>
<li>Calculer la valeur de la vraisemblance pour chaque valeur de la grille</li>
<li>Calculer le produit prior x vraisemblance pour chaque valeur de la grille, puis normalisation</li>
</ul>
</div>

<img data-src="Cours02_files/figure-revealjs/grid1-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="la-distribution-postérieure-grid-method-1" class="slide level2">
<h2>La distribution postérieure, grid method</h2>
<div>
<ul>
<li>Définir la grille</li>
<li><strong>Calculer la valeur du prior pour chaque valeur de la grille</strong></li>
<li>Calculer la valeur de la vraisemblance pour chaque valeur de la grille</li>
<li>Calculer le produit prior x vraisemblance pour chaque valeur de la grille, puis normalisation</li>
</ul>
</div>

<img data-src="Cours02_files/figure-revealjs/grid2-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="la-distribution-postérieure-grid-method-2" class="slide level2">
<h2>La distribution postérieure, grid method</h2>
<div>
<ul>
<li>Définir la grille</li>
<li>Calculer la valeur du prior pour chaque valeur de la grille</li>
<li><strong>Calculer la valeur de la vraisemblance pour chaque valeur de la grille</strong></li>
<li>Calculer le produit prior x vraisemblance pour chaque valeur de la grille, puis normalisation</li>
</ul>
</div>

<img data-src="Cours02_files/figure-revealjs/grid3-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="la-distribution-postérieure-grid-method-3" class="slide level2">
<h2>La distribution postérieure, grid method</h2>
<div>
<ul>
<li>Définir la grille</li>
<li>Calculer la valeur du prior pour chaque valeur de la grille</li>
<li>Calculer la valeur de la vraisemblance pour chaque valeur de la grille</li>
<li><strong>Calculer le produit prior x vraisemblance pour chaque valeur de la grille, puis normalisation</strong></li>
</ul>
</div>

<img data-src="Cours02_files/figure-revealjs/grid4-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="la-distribution-postérieure-grid-method-4" class="slide level2">
<h2>La distribution postérieure, grid method</h2>
<div>
<ul>
<li>Définir la grille</li>
<li>Calculer la valeur du prior pour chaque valeur de la grille</li>
<li>Calculer la valeur de la vraisemblance pour chaque valeur de la grille</li>
<li><strong>Calculer le produit prior x vraisemblance pour chaque valeur de la grille, puis normalisation</strong></li>
</ul>
</div>

<img data-src="Cours02_files/figure-revealjs/grid5-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="la-distribution-postérieure-grid-method-5" class="slide level2">
<h2>La distribution postérieure, grid method</h2>
<p>Problème du nombre de paramètres… En affinant la grille on augmente le temps de calcul :</p>
<ul>
<li class="fragment">3 paramètres avec une grille de <span class="math inline">\(10^3\)</span> noeuds = une grille de <span class="math inline">\(10^9\)</span> points de calcul</li>
<li class="fragment">10 paramètres avec une grille de <span class="math inline">\(10^3\)</span> noeuds = une grille de <span class="math inline">\(10^{30}\)</span> points de calcul</li>
</ul>
<div class="fragment">
<p>Le “superordinateur” chinois Tianhe-2 réalise <span class="math inline">\(33,8 \text{×} 10^{15}\)</span> opérations par seconde. Si on considère qu’il réalise 3 opérations par noeud de la grille, il lui faudrait <span class="math inline">\(10^{14}\)</span> secondes pour parcourir la grille une fois (pour comparaison, l’âge de l’univers est approximativement de <span class="math inline">\((4,354 ± 0,012)\text{×}10^{17}\)</span> secondes)…</p>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/work-gif_d91e193f68b1b082bde7cf91d70b9426">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="figures/not_gonna_work.gif" width="500"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="échantillonner-la-distribution-postérieure" class="slide level2">
<h2>Échantillonner la distribution postérieure</h2>
<p>Pour échantillonner une distribution postérieure, on peut utiliser différentes implémentations des méthodes MCMC (e.g., Metropolis-Hastings, Gibbs, Hamilton, cf.&nbsp;Cours n°05).</p>
<div class="fragment">
<p>En pratique :</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/sampling1_ca449b74799f4adb5b85ad892ccaf0cd">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>) <span class="co"># creates a grid</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>) <span class="co"># uniform prior</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(y, <span class="at">size =</span> n, <span class="at">prob =</span> p_grid) <span class="co"># computes likelihood</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>posterior <span class="ot">&lt;-</span> (likelihood <span class="sc">*</span> prior) <span class="sc">/</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior) <span class="co"># computes posterior</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(posterior, <span class="at">size =</span> <span class="fl">1e3</span>, <span class="at">prob =</span> posterior, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="co"># sampling</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="fu">hist</span>(samples, <span class="at">main =</span> <span class="st">""</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(theta), <span class="at">cex.axis =</span> <span class="dv">1</span>, <span class="at">cex.lab =</span> <span class="fl">1.5</span>) <span class="co"># histogram</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Cours02_files/figure-revealjs/sampling1-1.svg" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="échantillonner-la-distribution-postérieure-1" class="slide level2">
<h2>Échantillonner la distribution postérieure</h2>
<p>La précision de l’approximation dépend de la taille de l’échantillon…</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-4_5e86b3ed04ce45ba68953b1bf852dc30">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Cours02_files/figure-revealjs/unnamed-chunk-4-1.svg" width="1920"></p>
</figure>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-5_e124b85e2320909b808ed3f6396bc67c">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Cours02_files/figure-revealjs/unnamed-chunk-5-1.svg" width="1920"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="la-distribution-postérieure-résumé" class="slide level2">
<h2>La distribution postérieure, résumé</h2>
<p>Cas analytique :</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-6_3a4c12ea8bbb17c2fc92bbd102ea4ad0">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># parameters of the Beta prior</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>n <span class="ot">&lt;-</span> <span class="dv">9</span> <span class="co"># number of observations</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>y <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="co"># number of successes</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>posterior <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(p_grid, y <span class="sc">+</span> a, n <span class="sc">-</span> y <span class="sc">+</span> b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Grid method :</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-7_98445ff7994e32bb430475ff6e30b559">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">1000</span>) <span class="co"># uniform prior</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> y, <span class="at">size =</span> n, <span class="at">prob =</span> p_grid)</span>
<span id="cb9-4"><a href="#cb9-4"></a>posterior <span class="ot">&lt;-</span> (likelihood <span class="sc">*</span> prior) <span class="sc">/</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Échantillonner la distribution postérieure :</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-8_9985053e495c15e222a05489bdaacca5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">sample</span>(<span class="at">x =</span> p_grid, <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">prob =</span> posterior, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="la-distribution-postérieure-résumé-1" class="slide level2">
<h2>La distribution postérieure, résumé</h2>
<p><strong>Méthode analytique</strong></p>
<ul>
<li class="fragment">La distribution postérieure est décrite explicitement</li>
<li class="fragment">Le modèle est fortement contraint</li>
</ul>
<div class="fragment">
<p><strong>Méthode Grid</strong></p>
<ul>
<li class="fragment">La distribution postérieure n’est donnée que pour un ensemble fini de valeurs</li>
<li class="fragment">Plus la grille est fine, meilleure est l’estimation de la distribution postérieure</li>
<li class="fragment">Compromis <em>Précision - Temps de calcul</em></li>
</ul>
</div>
</section>
<section id="utiliser-les-échantillons-pour-résumer-la-distribution-postérieure" class="slide level2">
<h2>Utiliser les échantillons pour résumer la distribution postérieure</h2>
<p>Estimation de la tendance centrale : À partir d’un ensemble d’échantillons d’une distribution postérieure, on peut calculer la moyenne, le mode, et la médiane. Par exemple pour un prior uniforme, 10 lancers, et 3 Faces.</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/tendance-centrale1_0ecc9e5b17e8049a94b9acdbfbc53126">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>mode_posterior <span class="ot">&lt;-</span> <span class="fu">find_mode</span>(samples) <span class="co"># en bleu</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>mean_posterior <span class="ot">&lt;-</span> <span class="fu">mean</span>(samples) <span class="co"># en orange</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>median_posterior <span class="ot">&lt;-</span> <span class="fu">median</span>(samples) <span class="co"># en vert</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/tendance-centrale2_98d02cc8220c1bf6a9bcca9b5d6d1fee">

</div>

<img data-src="Cours02_files/figure-revealjs/tendance-centrale3-1.svg" width="1728" class="r-stretch quarto-figure-center"></section>
<section id="utiliser-les-échantillons-pour-résumer-la-distribution-postérieure-1" class="slide level2">
<h2>Utiliser les échantillons pour résumer la distribution postérieure</h2>
<p>Quelle est la probabilité que le biais de la pièce <span class="math inline">\(\theta\)</span> soit supérieur à 0.5 ?</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/superiority-prob_c103e4c82a1068f7611838859776b600">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">sum</span>(samples <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fu">length</span>(samples) <span class="co"># équivalent à mean(samples &gt; 0.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.112</code></pre>
</div>
</div>
<div class="fragment">
<p>Quelle est la probabilité que le biais de la pièce <span class="math inline">\(\theta\)</span> soit compris entre 0.2 et 0.4 ?</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/interval-prob_72632af5c306c43b94a0592484390619">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">sum</span>(samples <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> samples <span class="sc">&lt;</span> <span class="fl">0.4</span>) <span class="sc">/</span> <span class="fu">length</span>(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5482</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/interval-prob-plot_69343c898fc920824dbd8418297ecfe5">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Cours02_files/figure-revealjs/interval-prob-plot-1.svg" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="highest-density-interval-hdi" class="slide level2">
<h2>Highest density interval (HDI)</h2>
<p>Highest density interval (HDI) :</p>
<ul>
<li class="fragment">Le HDI indique les valeurs du paramètre qui sont les plus probables (sachant les données et le prior)</li>
<li class="fragment">Plus le HDI est étroit et plus le degré de certitude est élevé</li>
<li class="fragment">La largeur du HDI diminue avec l’augmentation du nombre de mesures</li>
</ul>
<div class="fragment">
<blockquote>
<p>Définition : les valeurs du paramètre <span class="math inline">\(\theta\)</span> contenues dans un HDI à 89% sont telles que <span class="math inline">\(p(\theta) &gt; W\)</span> où <span class="math inline">\(W\)</span> satisfait la condition suivante :</p>
<p><span class="math display">\[\int_{\theta \ : \ p(\theta) &gt; W} p(\theta) \, \mathrm{d} \theta = 0.89.\]</span></p>
</blockquote>
</div>
</section>
<section id="highest-density-interval-hdi-1" class="slide level2">
<h2>Highest density interval (HDI)</h2>

<img data-src="figures/HDI.png" style="width:35.0%" class="r-stretch quarto-figure-center"></section>
<section id="highest-density-interval-hdi-2" class="slide level2">
<h2>Highest density interval (HDI)</h2>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-9_ff7f46e079eb856840160df4b202ab5d">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">library</span>(BEST)</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="fu">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="fl">1e3</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a>pTheta <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(p_grid, <span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb16-6"><a href="#cb16-6"></a>massVec <span class="ot">&lt;-</span> pTheta <span class="sc">/</span> <span class="fu">sum</span>(pTheta)</span>
<span id="cb16-7"><a href="#cb16-7"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid, <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> pTheta)</span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="fu">plotPost</span>(samples, <span class="at">credMass =</span> <span class="fl">0.89</span>, <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(theta), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Cours02_files/figure-revealjs/unnamed-chunk-9-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="region-of-practical-equivalence-rope" class="slide level2">
<h2>Region of practical equivalence (ROPE)</h2>
<p>Cette procédure permet d’accepter ou de rejeter une valeur nulle (null value). La région d’équivalence pratique ou <em>region of practical equivalence</em> (ROPE) définit un intervalle de valeurs qu’on considère comment étant “équivalentes” à la valeur nulle. La figure ci-dessous résume les issues décisions possibles issues de cette procédure <span class="citation" data-cites="kruschke2018">(<a href="#/ref-kruschke2018" role="doc-biblioref" onclick="return false;">Kruschke, 2018</a>)</span>.</p>

<img data-src="figures/hdi_rope.png" style="width:50.0%" class="r-stretch quarto-figure-center"></section>
<section id="region-of-practical-equivalence-rope-1" class="slide level2">
<h2>Region of practical equivalence (ROPE)</h2>
<p>La valeur du paramètre (e.g., <span class="math inline">\(\theta = 0.5\)</span>) est rejetée si le HDI est entièrement hors de la ROPE. La valeur du paramètre (e.g., <span class="math inline">\(\theta = 0.5\)</span>) est acceptée si le HDI est entièrement dans la ROPE. Si le HDI et la ROPE se chevauchent on ne peut pas conclure…</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-11_09dadee23985c97183fe5848dbe2f51e">

</div>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-12_b398af50f25d1b917fef97c56ffe127b">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">plotPost</span>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="at">paramSampleVec =</span> samples, <span class="at">credMass =</span> <span class="fl">0.89</span>,</span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>, <span class="at">cex.lab =</span> <span class="dv">2</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(theta), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="at">ROPE =</span> <span class="fu">c</span>(<span class="fl">0.49</span>, <span class="fl">0.51</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Cours02_files/figure-revealjs/unnamed-chunk-12-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="comparaison-de-modèles" class="slide level2">
<h2>Comparaison de modèles</h2>
<p>On lance une pièce 200 fois et on obtient 115 “Faces”. Est-ce que la pièce est biaisée ? Nous construisons deux modèles et essayons de savoir lequel rend le mieux compte des données.</p>
<p><span class="math display">\[\begin{eqnarray*}
\left\{
\begin{array}{ll}
    \mathcal{M}_0: Y \sim \mathrm{Binomial}(n, \theta = 0.5) &amp; \quad \text{La pièce n'est pas biaisée}\\
    \mathcal{M}_1: Y \sim \mathrm{Binomial}(n, \theta \neq 0.5) &amp; \quad \text{La pièce est biaisée}
\end{array}\right.
\end{eqnarray*}\]</span></p>
<div class="fragment">
<p>Le facteur de Bayes (<em>Bayes factor</em>) fait le rapport des vraisemblances (marginales) des deux modèles.</p>
<p><span class="math display">\[\frac{p(\mathcal{M}_{0} | \text{data})}{p(\mathcal{M}_{1} | \text{data})} = \color{green}{\frac{p(\text{data} | \mathcal{M}_{0})}{p(\text{data} | \mathcal{M}_{1})}} \ \frac{p(\mathcal{M}_{0})}{p(\mathcal{M}_{1})}\]</span></p>
</div>
</section>
<section id="comparaison-de-modèles-1" class="slide level2">
<h2>Comparaison de modèles</h2>
<p>Le facteur de Bayes (Bayes factor) fait le rapport des vraisemblances (marginales) des deux modèles.</p>
<p><span class="math display">\[\frac{p(\mathcal{M}_{0} | \text{data})}{p(\mathcal{M}_{1} | \text{data})} = \color{green}{\frac{p(\text{data} | \mathcal{M}_{0})}{p(\text{data} | \mathcal{M}_{1})}} \ \frac{p(\mathcal{M}_{0})}{p(\mathcal{M}_{1})}\]</span></p>
<div class="fragment">
<p>Soit dans notre exemple :</p>
<p><span class="math display">\[BF_{01} = \frac{p(\mathcal{M}_{0} | \text{data})}{p(\mathcal{M}_{1} | \text{data})} = \frac{0.005955}{0.005} = 1.1971.\]</span></p>
<p>Le rapport de probabilités a augmenté de 20% en faveur de <span class="math inline">\(\mathcal{M}_{0}\)</span> après avoir pris connaissance des données. Le facteur de Bayes peut également s’interpréter de la manière suivante : Les données sont 1.2 fois plus probables sous le modèle <span class="math inline">\(\mathcal{M}_{0}\)</span> que sous le modèle <span class="math inline">\(\mathcal{M}_{1}\)</span>.</p>
</div>
</section>
<section id="model-checking" class="slide level2">
<h2>Model checking</h2>
<p>Les deux rôles de la fonction de vraisemblance :</p>
<ul>
<li class="fragment">C’est une fonction de <span class="math inline">\(\theta\)</span> pour le calcul de la distribution postérieure : <span class="math inline">\(\mathcal{L}(\theta \ | \ y, n)\)</span></li>
<li class="fragment">Lorsque <span class="math inline">\(\theta\)</span> est connu / fixé, c’est une distribution de probabilité : <span class="math inline">\(p(y \ |\ \theta, n) = \theta^y(1 - \theta)^{(n - y)}\)</span></li>
</ul>
<div class="fragment">
<p>On peut utiliser cette distribution de probabilité pour générer des données… !</p>
</div>
<div class="fragment">
<p>Par exemple : Générer 10000 valeurs à partir d’une loi binomiale basée sur 9 lancers et une probabilité de Face de 0.6 :</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-13_b815681eefa737ec92625f74d5cd4457">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="model-checking-1" class="slide level2">
<h2>Model checking</h2>
<p>Deux sources d’incertitude dans ces prédictions :</p>
<ul>
<li class="fragment">Incertitude liée au processus d’échantillonnage <br> -&gt; On tire une donnée issue d’une distribution Binomiale</li>
<li class="fragment">Incertitude sur la valeur de <span class="math inline">\(\theta\)</span> elle-même <br> -&gt; L’incertitude quant à la valeur de <span class="math inline">\(\theta\)</span> est représentée par une distribution de probabilité (postérieure)</li>
</ul>
<div class="fragment">
<p>Par exemple : Générer 10000 valeurs à partir d’une loi binomiale basé sur 9 lancers et une probabilité de Face décrite par la distribution postérieure de <span class="math inline">\(\theta\)</span> :</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-14_2d5cd73d8c93edbabbc075bb301ece76">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>posterior <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="at">n =</span> <span class="fl">1e4</span>, <span class="at">shape1 =</span> <span class="dv">16</span>, <span class="at">shape2 =</span> <span class="dv">10</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>samples <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fl">1e4</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> posterior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="prior-and-posterior-predictive-checking" class="slide level2">
<h2>Prior and posterior predictive checking</h2>

<img data-src="Cours02_files/figure-revealjs/ppc-1.svg" width="1152" class="r-stretch quarto-figure-center"></section>
<section id="posterior-predictive-checking" class="slide level2">
<h2>Posterior predictive checking</h2>

<img data-src="figures/ModelPredictions.jpg" style="width:75.0%" class="r-stretch quarto-figure-center"></section>
<section id="exercices" class="slide level2">
<h2>Exercices</h2>

<img data-src="figures/tartine.jpg" style="width:25.0%" class="r-stretch quarto-figure-center"><p>Un analyste qui travaille dans une fabrique de célèbres petits pains suédois a lu un livre qui soulevait une épineuse question… Pourquoi la tartine tombe toujours du côté du beurre ? À défaut de proposer une réponse plausible, il se propose de vérifier cette assertion. La première expérience qu’il réalise consiste à faire tomber une tartine beurrée de la hauteur d’une table. Les résultats obtenus sont accessibles dans le document suivant : <code>Cours02/data/experiment_TP2_1.csv</code>.</p>
</section>
<section id="récupérer-les-données" class="slide level2">
<h2>Récupérer les données</h2>
<p>Première tâche : Ouvrir ce fichier (utiliser si besoin les fonctions <code>getwd()</code> et <code>setwd()</code>).</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-15_dd3510c80fb7bab18c23bebab02f5843">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co"># importer les données</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/experiment_TP2_1.csv"</span>)</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co"># description sommaire des données</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  3 variables:
 $ X    : int  1 2 3 4 5 6 7 8 9 10 ...
 $ trial: int  1 2 3 4 5 6 7 8 9 10 ...
 $ value: int  0 0 1 0 0 1 1 1 0 0 ...</code></pre>
</div>
</div>
</section>
<section id="questions" class="slide level2">
<h2>Questions</h2>
<div>
<ul>
<li><p>La tartine n’ayant que deux faces, le résultat s’apparente à un tirage sur une loi binomiale de paramètre <span class="math inline">\(\theta\)</span> inconnu. Quelle est la distribution postérieure du paramètre <span class="math inline">\(\theta\)</span> au vue de ces données, sachant que l’analyste n’avait aucun a priori (vous pouvez également utiliser vos propres connaissances a priori).</p></li>
<li><p>Calculer le HDI à 95% de la distribution postérieure et en donner une représentation graphique (indice : utilisez le package <code>BEST</code>).</p></li>
<li><p>Peut-on rejeter l’hypothèse nulle selon laquelle <span class="math inline">\(\theta = 0.5\)</span> ? Répondez à cette question en utilisant la procédure HDI+ROPE.</p></li>
<li><p>Importer les observations du fichier <code>experiment_TP2_2.csv</code>. Mettre à jour le modèle en utilisant le mode de la distribution postérieure calculée précédemment.</p></li>
</ul>
</div>
</section>
<section id="proposition-de-solution---question-1" class="slide level2">
<h2>Proposition de solution - Question 1</h2>
<p>La tartine n’ayant que deux faces, le résultat s’apparente à un tirage sur une loi binomiale de paramètre <span class="math inline">\(\theta\)</span> inconnu. Quelle est la distribution postérieure du paramètre <span class="math inline">\(\theta\)</span> ?</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-16_af6ae0ca5bf3f9f72179421b03b4a3eb">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># nombre d'essais</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>nbTrial <span class="ot">&lt;-</span> <span class="fu">length</span>(data<span class="sc">$</span>trial)</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># nombre de "succès" (i.e., la tartine tombe du côté du beurre)</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>nbSuccess <span class="ot">&lt;-</span> <span class="fu">sum</span>(data<span class="sc">$</span>value)</span>
<span id="cb22-6"><a href="#cb22-6"></a></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co"># taile de la grille</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>grid_size <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb22-9"><a href="#cb22-9"></a></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co"># génère la grille</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>p_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> grid_size)</span>
<span id="cb22-12"><a href="#cb22-12"></a></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="co"># prior uniforme</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>prior <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, grid_size)</span>
<span id="cb22-15"><a href="#cb22-15"></a></span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="co"># calcul de la vraisemblance</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> nbSuccess, <span class="at">size =</span> nbTrial, <span class="at">prob =</span> p_grid)</span>
<span id="cb22-18"><a href="#cb22-18"></a></span>
<span id="cb22-19"><a href="#cb22-19"></a><span class="co"># calcul du posterior</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>posterior <span class="ot">&lt;-</span> likelihood <span class="sc">*</span> prior <span class="sc">/</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proposition-de-solution---question-2" class="slide level2">
<h2>Proposition de solution - Question 2</h2>
<p>Calculer le HDI à 95% de la distribution postérieure et en donner une représentation graphique.</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-17_5f8b761724b040fd019d333c34f76699">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> p_grid, <span class="at">prob =</span> posterior, <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">plotPost</span>(samples, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>, <span class="at">cex.lab =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(theta) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Cours02_files/figure-revealjs/unnamed-chunk-17-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="proposition-de-solution---question-3" class="slide level2">
<h2>Proposition de solution - Question 3</h2>
<p>Peut-on rejeter l’hypothèse nulle selon laquelle <span class="math inline">\(\theta = 0.5\)</span> ?</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-18_dc76d4a27100e9e6fa8af1e3894d1af6">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">plotPost</span>(</span>
<span id="cb24-2"><a href="#cb24-2"></a>  samples, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>, <span class="at">cex.lab =</span> <span class="dv">2</span>,</span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="at">ROPE =</span> <span class="fu">c</span>(<span class="fl">0.49</span>, <span class="fl">0.51</span>), <span class="at">compVal =</span> <span class="fl">0.5</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Cours02_files/figure-revealjs/unnamed-chunk-18-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="proposition-de-solution---question-4" class="slide level2">
<h2>Proposition de solution - Question 4</h2>
<p>À ce stade, on ne peut pas conclure. L’analyste décide de relancer une série d’observations afin d’affiner ses résultats.</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-19_846e756ec58820e2534504880fb0730f">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/experiment_TP2_2.csv"</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">str</span>(data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   500 obs. of  3 variables:
 $ X    : int  1 2 3 4 5 6 7 8 9 10 ...
 $ trial: int  1 2 3 4 5 6 7 8 9 10 ...
 $ value: int  1 1 0 1 0 0 1 1 1 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>nbTrial2 <span class="ot">&lt;-</span> <span class="fu">length</span>(data2<span class="sc">$</span>trial) <span class="co"># nombre d'essais</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>nbSucces2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(data2<span class="sc">$</span>value) <span class="co"># nombre de succès</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proposition-de-solution---question-4-1" class="slide level2">
<h2>Proposition de solution - Question 4</h2>
<p>On utilise le posterior précédent comme prior de ce nouveau modèle.</p>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-20_7bedc2c9244a68a4767d62a8c256687b">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>mode1 <span class="ot">&lt;-</span> <span class="fu">find_mode</span>(samples)</span>
<span id="cb28-2"><a href="#cb28-2"></a>prior2 <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(p_grid, mode1 <span class="sc">*</span> (nbTrial <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>, (<span class="dv">1</span> <span class="sc">-</span> mode1) <span class="sc">*</span> (nbTrial <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="fu">data.frame</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> prior2) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y) ) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(theta), <span class="at">y =</span> <span class="st">"Densité de probabilité"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Cours02_files/figure-revealjs/unnamed-chunk-20-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="proposition-de-solution---question-4-suite" class="slide level2">
<h2>Proposition de solution - Question 4 (suite)</h2>
<div class="cell" data-layout-align="center" data-hash="Cours02_cache/revealjs/unnamed-chunk-21_eb666e8fd850930180a4eeb0e09e4d83">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>likelihood2 <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> nbSucces2, <span class="at">size =</span> nbTrial2, <span class="at">prob =</span> p_grid)</span>
<span id="cb29-2"><a href="#cb29-2"></a>posterior2 <span class="ot">&lt;-</span> likelihood2 <span class="sc">*</span> prior2 <span class="sc">/</span> <span class="fu">sum</span>(likelihood2 <span class="sc">*</span> prior2)</span>
<span id="cb29-3"><a href="#cb29-3"></a>samples2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(p_grid, <span class="at">prob =</span> posterior2, <span class="at">size =</span> <span class="fl">1e4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="fu">plotPost</span>(</span>
<span id="cb29-6"><a href="#cb29-6"></a>  samples2, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">cex.axis =</span> <span class="fl">1.5</span>, <span class="at">cex.lab =</span> <span class="dv">2</span>,</span>
<span id="cb29-7"><a href="#cb29-7"></a>  <span class="at">xlab =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb29-8"><a href="#cb29-8"></a>  <span class="at">ROPE =</span> <span class="fu">c</span>(<span class="fl">0.49</span>, <span class="fl">0.51</span>), <span class="at">compVal =</span> <span class="fl">0.5</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="Cours02_files/figure-revealjs/unnamed-chunk-21-1.svg" width="960" class="r-stretch quarto-figure-center"></section>
<section id="références" class="slide level2 refs smaller scrollable">
<h2>Références</h2>


<img src="https://github.com/lnalborczyk/IMSB2021/raw/master/cover.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p>Ladislas Nalborczyk - IMSB2022</p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography">
<div id="ref-kruschke2018" class="csl-entry" role="doc-biblioentry">
Kruschke, J. K. (2018). Rejecting or Accepting Parameter Values in Bayesian Estimation. <em>Advances in Methods and Practices in Psychological Science</em>, <em>1</em>(2), 270–280. <a href="https://doi.org/10.1177/2515245918771304">https://doi.org/10.1177/2515245918771304</a>
</div>
<div id="ref-kruschke2015" class="csl-entry" role="doc-biblioentry">
Kruschke, J. K. (2015). <em>Doing Bayesian data analysis: a tutorial with R, JAGS, and Stan</em> (2nd Edition). Academic Press.
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: false,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.15,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>